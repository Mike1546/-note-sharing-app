"use strict";(self.webpackChunknote_sharing_app_client=self.webpackChunknote_sharing_app_client||[]).push([[627],{640:(e,t,a)=>{a.r(t),a.d(t,{createMessage:()=>o,default:()=>A,deleteMessage:()=>l,listMessages:()=>d,updateMessage:()=>c});var s=a(5404),r=a(5460);const n="69181c670024df0dd32b",i={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PROJECT_MESSAGES||"691fbecd000ac88f46a2";async function o(e){try{const{projectId:t,taskId:a=null,userId:o,userName:d,message:c,messageDate:l=null}=e;if(!t||!o||!c||!c.trim())throw new Error("projectId, userId, and message are required");const A={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PROJECTS||"691fba2b0003b7a35fc7",u=await s.LL.getDocument(n,A,t),P=[r.aX.read(r.Xh.user(u.ownerId)),r.aX.write(r.Xh.user(u.ownerId)),r.aX.update(r.Xh.user(u.ownerId)),r.aX.delete(r.Xh.user(u.ownerId)),...(u.accessGroup||[]).map((e=>r.aX.read(r.Xh.user(e)))),...(u.accessGroup||[]).map((e=>r.aX.write(r.Xh.user(e))))];return await s.LL.createDocument(n,i,r.ID.unique(),{projectId:t,taskId:a||null,userId:o,userName:d||"Unknown User",message:c.trim(),messageDate:l?new Date(l).toISOString():(new Date).toISOString(),createdAt:(new Date).toISOString()},P)}catch(t){throw console.error("Error creating message:",t),t}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const{projectId:t=null,taskId:a=null,sortBy:o="newest"}=e,d=[];t&&d.push(r.XK.equal("projectId",t)),a&&d.push(r.XK.equal("taskId",a));let c=(await s.LL.listDocuments(n,i,d)).documents||[];return"newest"===o?c.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))):c.sort(((e,t)=>new Date(e.createdAt)-new Date(t.createdAt))),c}catch(a){var t;return 404===a.code||null!==(t=a.message)&&void 0!==t&&t.includes("not be found")?(console.warn("[ProjectMessages] Collection not found, returning empty array"),[]):(console.error("Error listing messages:",a),[])}}async function c(e,t){try{return await s.LL.updateDocument(n,i,e,t)}catch(a){throw console.error("Error updating message:",a),a}}async function l(e){try{return await s.LL.deleteDocument(n,i,e)}catch(t){throw console.error("Error deleting message:",t),t}}const A={createMessage:o,listMessages:d,updateMessage:c,deleteMessage:l}},3560:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(9662),r=a(579);const n=(0,s.A)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},3768:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(9662),r=a(579);const n=(0,s.A)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},3835:(e,t,a)=>{a.r(t),a.d(t,{createActivityLog:()=>o,default:()=>c,listActivityLogs:()=>d});var s=a(5404),r=a(5460);const n="69181c670024df0dd32b",i={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_ACTIVITY_LOGS||"691fba55002692c63497";async function o(e){try{const{projectId:a=null,taskId:o=null,userId:d,userName:c,category:l,action:A,oldValue:u=null,newValue:P=null}=e;if(!d||!l||!A)throw new Error("userId, category, and action are required");let _=[r.aX.read(r.Xh.users())];if(a){const e={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PROJECTS||"691fba2b0003b7a35fc7";try{const t=await s.LL.getDocument(n,e,a);_=[r.aX.read(r.Xh.user(t.ownerId)),...(t.accessGroup||[]).map((e=>r.aX.read(r.Xh.user(e))))]}catch(t){}}return await s.LL.createDocument(n,i,r.ID.unique(),{projectId:a||null,taskId:o||null,userId:d,userName:c||"Unknown User",category:l,action:A,oldValue:u||null,newValue:P||null,timestamp:(new Date).toISOString()},_)}catch(a){throw console.error("Error creating activity log:",a),a}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const{projectId:t=null,taskId:a=null,category:o=null,userId:d=null,search:c="",sortBy:l="newest"}=e,A=[];t&&A.push(r.XK.equal("projectId",t)),a&&A.push(r.XK.equal("taskId",a)),o&&A.push(r.XK.equal("category",o)),d&&A.push(r.XK.equal("userId",d));let u=(await s.LL.listDocuments(n,i,A)).documents||[];if(c){const e=c.toLowerCase();u=u.filter((t=>{var a,s,r;return(null===(a=t.action)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(s=t.userName)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(r=t.category)||void 0===r?void 0:r.toLowerCase().includes(e))}))}return"newest"===l?u.sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))):u.sort(((e,t)=>new Date(e.timestamp)-new Date(t.timestamp))),u}catch(t){return console.error("Error listing activity logs:",t),[]}}const c={createActivityLog:o,listActivityLogs:d}},4155:(e,t,a)=>{a.d(t,{Ay:()=>d});var s=a(5404),r=a(5460);const n="69181c670024df0dd32b",i={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_TASKS||"691fba3e0012d16c1016";async function o(e){try{const t=await s.LL.listDocuments(n,i,[r.XK.equal("projectId",e)]);return(t.documents||[]).map((e=>({...e,subtasks:e.subtasks?JSON.parse(e.subtasks):[],attachments:e.attachments?JSON.parse(e.attachments):[]})))}catch(t){return console.error("Error listing tasks:",t),[]}}const d={createTask:async function(e,t,a){try{const{title:o,description:d="",dueDate:c=null,priority:l="Medium",status:A="Not Started",subtasks:u=[],attachments:P=[]}=t;if(!o||!o.trim())throw new Error("Task title is required");const _=(new Date).toISOString(),E={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PROJECTS||"691fba2b0003b7a35fc7",T=await s.LL.getDocument(n,E,e),C=[r.aX.read(r.Xh.user(T.ownerId)),r.aX.update(r.Xh.user(T.ownerId)),r.aX.delete(r.Xh.user(T.ownerId)),...(T.accessGroup||[]).map((e=>r.aX.read(r.Xh.user(e)))),...(T.accessGroup||[]).map((e=>r.aX.update(r.Xh.user(e))))],h={projectId:e,title:o.trim(),description:d,dueDate:c?new Date(c).toISOString():null,priority:l,status:A,subtasks:JSON.stringify(Array.isArray(u)?u:[]),attachments:JSON.stringify(Array.isArray(P)?P:[]),createdAt:_,updatedAt:_,createdBy:a};return await s.LL.createDocument(n,i,r.ID.unique(),h,C)}catch(o){throw console.error("Error creating task:",o),o}},listTasks:o,getTask:async function(e){try{const t=await s.LL.getDocument(n,i,e);return{...t,subtasks:t.subtasks?JSON.parse(t.subtasks):[],attachments:t.attachments?JSON.parse(t.attachments):[]}}catch(t){throw console.error("Error getting task:",t),t}},updateTask:async function(e,t){try{const a={...t,updatedAt:(new Date).toISOString()};return a.subtasks&&(a.subtasks=JSON.stringify(Array.isArray(a.subtasks)?a.subtasks:[])),a.attachments&&(a.attachments=JSON.stringify(Array.isArray(a.attachments)?a.attachments:[])),delete a.comments,a.dueDate&&(a.dueDate=new Date(a.dueDate).toISOString()),await s.LL.updateDocument(n,i,e,a)}catch(a){throw console.error("Error updating task:",a),a}},deleteTask:async function(e){try{return await s.LL.deleteDocument(n,i,e)}catch(t){throw console.error("Error deleting task:",t),t}},getOverdueTasks:async function(e){try{const t={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PROJECTS||"691fba2b0003b7a35fc7",a=await s.LL.listDocuments(n,t,[r.XK.equal("ownerId",e)]),i=await s.LL.listDocuments(n,t,[r.XK.search("accessGroup",e)]),d=[...a.documents||[],...i.documents||[]],c=Array.from(new Set(d.map((e=>e.$id)))),l=(new Date).toISOString(),A=[];for(const e of c){const t=(await o(e)).filter((e=>e.dueDate&&new Date(e.dueDate)<new Date(l)&&"Completed"!==e.status));A.push(...t)}return A}catch(t){return console.error("Error getting overdue tasks:",t),[]}}}},6627:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var s=a(5043),r=a(9252),n=a(5865),i=a(6446),o=a(3438),d=a(547),c=a(2110),l=a(6494),A=a(7784),u=a(3193),P=a(9190),_=a(598),E=a(2143),T=a(3845),C=a(5721),h=a(4628),p=a(7392),I=a(8734),m=a(9336),R=a(35),O=a(6600),y=a(5316),S=a(9347),x=a(7332),g=a(3560),L=a(3768),D=a(7225),f=a(8606),v=a(9662),w=a(579);const j=(0,v.A)((0,w.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonUnchecked");var N=a(3216),b=a(5016),k=a(4155),W=a(3835),U=a(640),B=a(446),Y=a.n(B);const M=()=>{const{projectId:e,taskId:t}=(0,N.g)(),v=(0,N.Zp)(),{user:B}=(0,b.A)(),[M,K]=(0,s.useState)(null),[X,V]=(0,s.useState)([]),[F,H]=(0,s.useState)([]),[q,$]=(0,s.useState)(!1),[J,G]=(0,s.useState)(""),[z,Q]=(0,s.useState)(""),[Z,ee]=(0,s.useState)(!1),[te,ae]=(0,s.useState)({title:"",description:"",dueDate:"",priority:"Medium",status:"Not Started"}),[se,re]=(0,s.useState)(""),[ne,ie]=(0,s.useState)(""),[oe,de]=(0,s.useState)(!1);(0,s.useEffect)((()=>{t&&null!==B&&void 0!==B&&B.$id&&(le(),Ae(),ce())}),[t,null===B||void 0===B?void 0:B.$id]);const ce=async()=>{try{const e=await U.default.listMessages({taskId:t,sortBy:"newest"});H(e)}catch(e){console.error("Error fetching task comments:",e)}},le=async()=>{try{const e=await k.Ay.getTask(t);K(e),ae({title:e.title||"",description:e.description||"",dueDate:e.dueDate?Y()(e.dueDate).format("YYYY-MM-DD"):"",priority:e.priority||"Medium",status:e.status||"Not Started"})}catch(e){G("Failed to load task")}},Ae=async()=>{try{const e=await W.default.listActivityLogs({taskId:t,sortBy:"newest"});V(e)}catch(e){console.error("Error fetching activity logs:",e)}},ue=async()=>{if(!se.trim())return;const a=[...M.subtasks||[],{id:Date.now(),text:se.trim(),completed:!1}];$(!0);try{await k.Ay.updateTask(t,{subtasks:a}),await W.default.createActivityLog({projectId:e,taskId:t,userId:B.$id,userName:B.name||B.email,category:"Task Update",action:`Added subtask: ${se}`,newValue:se}),re(""),await le(),await Ae()}catch(s){G((null===s||void 0===s?void 0:s.message)||"Failed to add subtask")}finally{$(!1)}},Pe=e=>!!e&&(new Date(e)<new Date&&new Date(e).toDateString()!==(new Date).toDateString());return M?(0,w.jsxs)(r.A,{maxWidth:"lg",sx:{py:4},children:[(0,w.jsxs)(i.A,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[(0,w.jsx)(o.A,{startIcon:(0,w.jsx)(x.A,{}),onClick:()=>v(`/projects/${e}`),sx:{textTransform:"none"},children:"Back to Project"}),(0,w.jsx)(i.A,{sx:{flexGrow:1}}),!Z&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(o.A,{variant:"outlined",startIcon:(0,w.jsx)(g.A,{}),onClick:()=>ee(!0),sx:{textTransform:"none"},children:"Edit"}),(0,w.jsx)(o.A,{variant:"outlined",color:"error",startIcon:(0,w.jsx)(L.A,{}),onClick:()=>de(!0),sx:{textTransform:"none"},children:"Delete"})]})]}),J&&(0,w.jsx)(d.A,{severity:"error",sx:{mb:2},onClose:()=>G(""),children:J}),z&&(0,w.jsx)(d.A,{severity:"success",sx:{mb:2},onClose:()=>Q(""),children:z}),(0,w.jsx)(c.A,{sx:{mb:3},children:(0,w.jsx)(l.A,{children:Z?(0,w.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,w.jsx)(A.A,{fullWidth:!0,label:"Task Title",value:te.title,onChange:e=>ae((t=>({...t,title:e.target.value}))),required:!0}),(0,w.jsx)(A.A,{fullWidth:!0,label:"Description",value:te.description,onChange:e=>ae((t=>({...t,description:e.target.value}))),multiline:!0,rows:4}),(0,w.jsx)(A.A,{fullWidth:!0,label:"Due Date",type:"date",value:te.dueDate,onChange:e=>ae((t=>({...t,dueDate:e.target.value}))),InputLabelProps:{shrink:!0}}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:2},children:[(0,w.jsxs)(u.A,{fullWidth:!0,children:[(0,w.jsx)(P.A,{children:"Priority"}),(0,w.jsxs)(_.A,{value:te.priority,onChange:e=>ae((t=>({...t,priority:e.target.value}))),label:"Priority",children:[(0,w.jsx)(E.A,{value:"Low",children:"Low"}),(0,w.jsx)(E.A,{value:"Medium",children:"Medium"}),(0,w.jsx)(E.A,{value:"High",children:"High"}),(0,w.jsx)(E.A,{value:"Critical",children:"Critical"})]})]}),(0,w.jsxs)(u.A,{fullWidth:!0,children:[(0,w.jsx)(P.A,{children:"Status"}),(0,w.jsxs)(_.A,{value:te.status,onChange:e=>ae((t=>({...t,status:e.target.value}))),label:"Status",children:[(0,w.jsx)(E.A,{value:"Not Started",children:"Not Started"}),(0,w.jsx)(E.A,{value:"Active",children:"Active"}),(0,w.jsx)(E.A,{value:"Blocked",children:"Blocked"}),(0,w.jsx)(E.A,{value:"Completed",children:"Completed"})]})]})]}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,w.jsx)(o.A,{onClick:()=>ee(!1),children:"Cancel"}),(0,w.jsx)(o.A,{onClick:async()=>{$(!0);try{const a={...M};await k.Ay.updateTask(t,te);const s=[];a.title!==te.title&&s.push(`Title: ${a.title} \u2192 ${te.title}`),a.status!==te.status&&s.push(`Status: ${a.status} \u2192 ${te.status}`),a.priority!==te.priority&&s.push(`Priority: ${a.priority} \u2192 ${te.priority}`),s.length>0&&await W.default.createActivityLog({projectId:e,taskId:t,userId:B.$id,userName:B.name||B.email,category:"Task Update",action:`Updated task: ${s.join(", ")}`,oldValue:JSON.stringify(a),newValue:JSON.stringify(te)}),Q("Task updated successfully"),ee(!1),await le(),await Ae(),setTimeout((()=>Q("")),3e3)}catch(a){G((null===a||void 0===a?void 0:a.message)||"Failed to update task")}finally{$(!1)}},variant:"contained",disabled:q||!te.title.trim(),children:"Save"})]})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,w.jsx)(n.A,{variant:"h4",sx:{fontWeight:"bold",flexGrow:1},children:M.title}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,w.jsx)(T.A,{label:M.priority,color:(_e=M.priority,{Low:"success",Medium:"warning",High:"error",Critical:"error"}[_e]||"default")}),(0,w.jsx)(T.A,{label:M.status})]})]}),(0,w.jsx)(n.A,{variant:"body1",sx:{mb:2,color:"text.secondary"},children:M.description||"No description"}),M.dueDate&&(0,w.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,w.jsx)(D.A,{color:Pe(M.dueDate)?"error":"action"}),(0,w.jsxs)(n.A,{variant:"body2",color:Pe(M.dueDate)?"error.main":"text.secondary",sx:{fontWeight:Pe(M.dueDate)?"bold":"normal"},children:["Due: ",Y()(M.dueDate).format("MMMM D, YYYY"),Pe(M.dueDate)&&" (Overdue!)"]}),(0,w.jsx)(o.A,{size:"small",onClick:()=>v(`/calendar?date=${Y()(M.dueDate).format("YYYY-MM-DD")}`),sx:{ml:2,textTransform:"none"},children:"View in Calendar"})]})]})})}),(0,w.jsx)(c.A,{sx:{mb:3},children:(0,w.jsxs)(l.A,{children:[(0,w.jsx)(n.A,{variant:"h6",sx:{mb:2},children:"Subtasks"}),M.subtasks&&M.subtasks.length>0?(0,w.jsx)(C.A,{children:M.subtasks.map((e=>(0,w.jsxs)(h.Ay,{children:[(0,w.jsx)(p.A,{onClick:()=>(async e=>{const a=M.subtasks.map((t=>t.id===e?{...t,completed:!t.completed}:t));$(!0);try{await k.Ay.updateTask(t,{subtasks:a}),await le()}catch(s){G((null===s||void 0===s?void 0:s.message)||"Failed to update subtask")}finally{$(!1)}})(e.id),sx:{mr:1},children:e.completed?(0,w.jsx)(f.A,{color:"success"}):(0,w.jsx)(j,{})}),(0,w.jsx)(I.A,{primary:e.text,sx:{textDecoration:e.completed?"line-through":"none",color:e.completed?"text.secondary":"text.primary"}})]},e.id)))}):(0,w.jsx)(n.A,{variant:"body2",color:"text.secondary",children:"No subtasks yet"}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:1,mt:2},children:[(0,w.jsx)(A.A,{fullWidth:!0,size:"small",placeholder:"Add subtask...",value:se,onChange:e=>re(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),ue())}}),(0,w.jsx)(o.A,{variant:"outlined",onClick:ue,disabled:!se.trim(),children:"Add"})]})]})}),(0,w.jsx)(c.A,{sx:{mb:3},children:(0,w.jsxs)(l.A,{children:[(0,w.jsx)(n.A,{variant:"h6",sx:{mb:2},children:"Comments"}),F&&F.length>0?(0,w.jsx)(C.A,{children:F.map(((e,t)=>(0,w.jsxs)(s.Fragment,{children:[(0,w.jsx)(h.Ay,{children:(0,w.jsx)(I.A,{primary:e.message,secondary:`${e.userName} \u2022 ${Y()(e.messageDate).format("MMM D, YYYY")} \u2022 ${Y()(e.createdAt).format("h:mm A")}`})}),t<F.length-1&&(0,w.jsx)(m.A,{})]},e.$id)))}):(0,w.jsx)(n.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"No comments yet"}),(0,w.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,w.jsx)(A.A,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Add a comment...",value:ne,onChange:e=>ie(e.target.value)}),(0,w.jsx)(o.A,{variant:"outlined",onClick:async()=>{if(ne.trim()){$(!0);try{const s=(await Promise.resolve().then(a.bind(a,640))).default;await s.createMessage({projectId:e,taskId:t,userId:B.$id,userName:B.name||B.email,message:ne.trim(),messageDate:(new Date).toISOString()}),await W.default.createActivityLog({projectId:e,taskId:t,userId:B.$id,userName:B.name||B.email,category:"Comment Added",action:"Added comment",newValue:ne}),ie(""),await ce(),await Ae()}catch(s){G((null===s||void 0===s?void 0:s.message)||"Failed to add comment")}finally{$(!1)}}},disabled:!ne.trim(),children:"Add"})]})]})}),(0,w.jsx)(c.A,{children:(0,w.jsxs)(l.A,{children:[(0,w.jsx)(n.A,{variant:"h6",sx:{mb:2},children:"Activity History"}),(0,w.jsx)(C.A,{children:0===X.length?(0,w.jsx)(h.Ay,{children:(0,w.jsx)(I.A,{primary:"No activity yet"})}):X.map(((e,t)=>(0,w.jsxs)(s.Fragment,{children:[(0,w.jsxs)(h.Ay,{children:[(0,w.jsx)(I.A,{primary:e.action,secondary:(0,w.jsxs)(i.A,{children:[(0,w.jsxs)(n.A,{variant:"caption",color:"text.secondary",children:[e.userName," \u2022 ",Y()(e.timestamp).format("MMM D, YYYY h:mm A")]}),e.oldValue&&e.newValue&&(0,w.jsxs)(n.A,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:[e.oldValue," \u2192 ",e.newValue]})]})}),(0,w.jsx)(T.A,{label:e.category,size:"small"})]}),t<X.length-1&&(0,w.jsx)(m.A,{})]},e.$id)))})]})}),(0,w.jsxs)(R.A,{open:oe,onClose:()=>de(!1),children:[(0,w.jsx)(O.A,{children:"Delete Task"}),(0,w.jsx)(y.A,{children:(0,w.jsxs)(n.A,{children:['Are you sure you want to delete "',M.title,'"? This cannot be undone.']})}),(0,w.jsxs)(S.A,{children:[(0,w.jsx)(o.A,{onClick:()=>de(!1),children:"Cancel"}),(0,w.jsx)(o.A,{onClick:async()=>{$(!0);try{await k.Ay.deleteTask(t),await W.default.createActivityLog({projectId:e,userId:B.$id,userName:B.name||B.email,category:"Task Update",action:`Deleted task: ${M.title}`,oldValue:M.title}),v(`/projects/${e}`)}catch(a){G((null===a||void 0===a?void 0:a.message)||"Failed to delete task"),$(!1)}},color:"error",variant:"contained",disabled:q,children:"Delete"})]})]})]}):(0,w.jsx)(r.A,{maxWidth:"lg",sx:{py:4},children:(0,w.jsx)(n.A,{children:"Loading task..."})});var _e}},7225:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(9662),r=a(579);const n=(0,s.A)((0,r.jsx)("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday")},8606:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(9662),r=a(579);const n=(0,s.A)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle")}}]);
//# sourceMappingURL=627.73bdf801.chunk.js.map