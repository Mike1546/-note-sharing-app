(self.webpackChunknote_sharing_app_client=self.webpackChunknote_sharing_app_client||[]).push([[325],{1321:(e,r,s)=>{"use strict";s.d(r,{A:()=>d});var o=s(6213);const t=window.location.hostname.includes("100.127.255"),n="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,a=t?{NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_TWINGATE_API_URL:n?"http://localhost:5000":"https://note-sharing-app.onrender.com";console.log("API Base URL:",a);const i=o.A.create({baseURL:a,withCredentials:!0,headers:{"Content-Type":"application/json"}});i.interceptors.request.use((e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e}),(e=>Promise.reject(e))),i.interceptors.response.use((e=>e),(e=>{var r;return 401===(null===(r=e.response)||void 0===r?void 0:r.status)&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)}));const d=i},1963:(e,r,s)=>{"use strict";s.d(r,{Ay:()=>c});var o=s(8561),t=s.n(o),n=s(5404),a=s(5460);const i="69181c670024df0dd32b",d="6918f63900228f33e93c",l="AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U=";const c={createPassword:async function(e,r){if(console.log("[Password Manager] Creating password entry",{userId:e,entry:r,collectionId:d}),!r.title)throw new Error("Title is required");const s={...r,ownerId:e};var o;if(r.password&&(s.encryptedPassword=(o=r.password,t().AES.encrypt(o,l).toString()),delete s.password),!s.encryptedPassword)throw new Error("Password is required");try{const e=await n.LL.createDocument(i,d,a.ID.unique(),s);return console.log("[Password Manager] Password created successfully",e.$id),e}catch(c){throw console.error("[Password Manager] Create error:",c),console.error("[Password Manager] Error details:",{message:c.message,code:c.code,type:c.type,response:c.response}),c}},listPasswords:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const r=e?[a.XK.equal("ownerId",e)]:[],s=(await n.LL.listDocuments(i,d,r)).documents||[],o="6918f632002d42536ab2";return await Promise.all(s.map((async e=>{if(!e.ownerId)return e;try{const r=await n.LL.listDocuments(i,o,[a.XK.equal("userId",e.ownerId)]);if(r.documents&&r.documents.length>0){const s=r.documents[0];return{...e,owner:{name:s.name||s.email||"Unknown",email:s.email||""}}}return{...e,owner:{name:"Unknown User",email:""}}}catch(r){return console.warn(`Failed to fetch profile for owner ${e.ownerId}:`,r),{...e,owner:{name:"Unknown User",email:""}}}})))}catch(r){return console.warn("Failed to fetch passwords:",r),[]}},getDecryptedPassword:async function(e){try{return r=e,t().AES.decrypt(r,l).toString(t().enc.Utf8)}catch(s){throw console.error("Decrypt error",s),s}var r},deletePassword:async function(e){return n.LL.deleteDocument(i,d,e)}}},2110:(e,r,s)=>{"use strict";s.d(r,{A:()=>A});var o=s(8168),t=s(8587),n=s(5043),a=s(8387),i=s(5049),d=s(4535),l=s(2876),c=s(3336),u=s(4987),m=s(239);function p(e){return(0,m.Ay)("MuiCard",e)}(0,u.A)("MuiCard",["root"]);var h=s(579);const x=["className","raised"],v=(0,d.Ay)(c.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,r)=>r.root})((()=>({overflow:"hidden"}))),A=n.forwardRef((function(e,r){const s=(0,l.A)({props:e,name:"MuiCard"}),{className:n,raised:d=!1}=s,c=(0,t.A)(s,x),u=(0,o.A)({},s,{raised:d}),m=(e=>{const{classes:r}=e;return(0,i.A)({root:["root"]},p,r)})(u);return(0,h.jsx)(v,(0,o.A)({className:(0,a.A)(m.root,n),elevation:d?8:void 0,ref:r,ownerState:u},c))}))},2301:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>ae});var o=s(5043),t=s(9252),n=s(6446),a=s(5865),i=s(8911),d=s(4605),l=s(7843),c=s(3438),u=s(547),m=s(4912),p=s(4056),h=s(35),x=s(6600),v=s(5316),A=s(9662),w=s(579);const y=(0,A.A)((0,w.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload"),f=(0,A.A)((0,w.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");var g=s(141),b=s(1321),j=s(5016),P=s(6931),C=s(3248),S=s(7097),I=s(1963);var T=s(2110),_=s(3845),R=s(6494),E=s(7600),W=s(7392),O=s(1637),L=s(8903),k=s(3559),D=s(3632);const N=(0,A.A)((0,w.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy");var U=s(3560),M=s(3768),z=s(7784),F=s(3193),$=s(9190),G=s(598),q=s(2143),X=s(1673);const B=e=>{let{entry:r,groups:s,onSubmit:t,onCancel:i}=e;const[d,l]=(0,o.useState)({title:"",username:"",password:"",url:"",notes:"",groupId:""});(0,o.useEffect)((()=>{var e;r&&l({title:r.title,username:r.username,password:r.password,url:r.url||"",notes:r.notes||"",groupId:(null===(e=r.group)||void 0===e?void 0:e._id)||""})}),[r]);const u=e=>{l({...d,[e.target.name]:e.target.value})};return(0,w.jsx)(n.A,{component:"form",onSubmit:e=>{e.preventDefault();const r={...d};r.groupId||delete r.groupId,delete r.permissions,t(r)},sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:(0,w.jsxs)(L.Ay,{container:!0,spacing:2,children:[(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Title",name:"title",value:d.title,onChange:u,required:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Username",name:"username",value:d.username,onChange:u,required:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Password",name:"password",type:"password",value:d.password,onChange:u,required:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,fontFamily:"monospace"}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"URL",name:"url",value:d.url,onChange:u,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Notes",name:"notes",multiline:!0,rows:3,value:d.notes,onChange:u,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),s&&s.length>0&&(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(L.Ay,{item:!0,xs:12,children:[(0,w.jsx)(a.A,{variant:"subtitle2",sx:{mb:1,fontWeight:"medium",color:"text.primary"},children:"Share with Group"}),(0,w.jsxs)(F.A,{fullWidth:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}},children:[(0,w.jsx)($.A,{children:"Group"}),(0,w.jsxs)(G.A,{name:"groupId",value:d.groupId,onChange:u,label:"Group",children:[(0,w.jsx)(q.A,{value:"",children:"Don't share"}),s.map((e=>(0,w.jsx)(q.A,{value:e._id,children:e.name},e._id)))]}),(0,w.jsx)(X.A,{children:"Group members will be able to view this password"})]})]})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsxs)(n.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1,mt:1},children:[(0,w.jsx)(c.A,{onClick:i,size:"small",sx:{textTransform:"none",fontWeight:"medium"},children:"Cancel"}),(0,w.jsxs)(c.A,{type:"submit",variant:"contained",size:"small",sx:{textTransform:"none",fontWeight:"medium"},children:[r?"Update":"Add"," Password"]})]})})]})})},H=e=>{let{entries:r,onUpdate:s,onDelete:t,isLoading:i=!1}=e;const{user:d}=(0,j.A)(),[l,c]=(0,o.useState)(!1),[m,p]=(0,o.useState)(null),[A,y]=(0,o.useState)({}),[f,g]=(0,o.useState)(""),[b,P]=(0,o.useState)(""),C=e=>{var r,s,o;if("admin"===(null===d||void 0===d||null===(r=d.profile)||void 0===r?void 0:r.role)||null!==d&&void 0!==d&&d.isAdmin)return!0;const t=e.ownerId||(null===(s=e.owner)||void 0===s?void 0:s._id)||(null===(o=e.owner)||void 0===o?void 0:o.$id)||e.owner,n=(null===d||void 0===d?void 0:d.$id)||(null===d||void 0===d?void 0:d._id)||(null===d||void 0===d?void 0:d.userId);if(t===n)return!0;if(e.group&&e.group.members){const r=e.group.members.find((e=>{var r,s;return((null===(r=e.user)||void 0===r?void 0:r._id)||(null===(s=e.user)||void 0===s?void 0:s.$id)||e.user)===n}));return"admin"===(null===r||void 0===r?void 0:r.role)}return!1},S=e=>{var r,s,o;if("admin"===(null===d||void 0===d||null===(r=d.profile)||void 0===r?void 0:r.role)||null!==d&&void 0!==d&&d.isAdmin)return!0;const t=e.ownerId||(null===(s=e.owner)||void 0===s?void 0:s._id)||(null===(o=e.owner)||void 0===o?void 0:o.$id)||e.owner,n=(null===d||void 0===d?void 0:d.$id)||(null===d||void 0===d?void 0:d._id)||(null===d||void 0===d?void 0:d.userId);if(t===n)return!0;if(e.group&&e.group.members){return!!e.group.members.find((e=>{var r,s;return((null===(r=e.user)||void 0===r?void 0:r._id)||(null===(s=e.user)||void 0===s?void 0:s.$id)||e.user)===n}))}return!1},z=r.reduce(((e,r)=>{var s,o;const t=r.groupId||(null===(s=r.group)||void 0===s?void 0:s._id)||(null===(o=r.group)||void 0===o?void 0:o.$id);if(t){var n;if(!e.groups[t])e.groups[t]={name:(null===(n=r.group)||void 0===n?void 0:n.name)||"Group",entries:[]};e.groups[t].entries.push(r)}else e.personal.push(r);return e}),{personal:[],groups:{}}),F=e=>{var r;let{entry:o}=e;const i=(null===o||void 0===o?void 0:o.$id)||(null===o||void 0===o?void 0:o._id);if(!o||!i)return null;const d=A[i]||!1;return(0,w.jsxs)(T.A,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:1,boxShadow:2,position:"relative"},children:[o.group&&(0,w.jsx)(_.A,{label:o.group.name,size:"small",color:"primary",sx:{position:"absolute",top:8,right:8,fontSize:"0.75rem",height:"24px"}}),(0,w.jsxs)(R.A,{sx:{flexGrow:1,pb:1,pt:o.group?4:2},children:[(0,w.jsx)(a.A,{variant:"h6",sx:{mb:2,fontWeight:"medium",color:"primary.main",pr:o.group?8:0},children:o.title}),o.ownerId&&(0,w.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[(0,w.jsx)(a.A,{variant:"body2",sx:{mr:1,minWidth:"80px",fontWeight:"medium"},children:"Owner:"}),(0,w.jsx)(a.A,{variant:"body2",sx:{flexGrow:1,color:"text.secondary"},children:(null===(r=o.owner)||void 0===r?void 0:r.name)||o.ownerId||"You"})]}),(0,w.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[(0,w.jsx)(a.A,{variant:"body2",sx:{mr:1,minWidth:"80px",fontWeight:"medium"},children:"Username:"}),(0,w.jsx)(a.A,{variant:"body2",sx:{flexGrow:1},children:o.username})]}),(0,w.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[(0,w.jsx)(a.A,{variant:"body2",sx:{mr:1,minWidth:"80px",fontWeight:"medium"},children:"Password:"}),(0,w.jsx)(a.A,{variant:"body2",sx:{fontFamily:"monospace",flexGrow:1,bgcolor:"action.hover",borderRadius:1,p:1},children:d&&A[i]?A[i]:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]}),o.url&&(0,w.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1.5},children:[(0,w.jsx)(a.A,{variant:"body2",sx:{mr:1,minWidth:"80px",fontWeight:"medium"},children:"URL:"}),(0,w.jsx)(a.A,{variant:"body2",sx:{flexGrow:1,color:"text.secondary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{color:"primary.main",textDecoration:"underline",cursor:"pointer"}},onClick:()=>o.url&&window.open(o.url,"_blank"),children:o.url})]}),o.notes&&(0,w.jsxs)(n.A,{sx:{display:"flex",alignItems:"flex-start",mt:1},children:[(0,w.jsx)(a.A,{variant:"body2",sx:{mr:1,minWidth:"80px",fontWeight:"medium"},children:"Notes:"}),(0,w.jsx)(a.A,{variant:"body2",sx:{color:"text.secondary",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",whiteSpace:"pre-line",wordBreak:"break-word",maxWidth:"calc(100% - 90px)",bgcolor:"action.hover",borderRadius:1,p:1},children:o.notes})]})]}),(0,w.jsx)(E.A,{sx:{px:2,py:1,borderTop:1,borderColor:"divider",bgcolor:"background.default"},children:(0,w.jsxs)(n.A,{sx:{display:"flex",gap:1,ml:"auto"},children:[(0,w.jsx)(W.A,{size:"small",onClick:()=>{console.log("Toggle clicked for:",i),(async(e,r)=>{if(console.log("Toggle called for:",e),A[e])y((r=>({...r,[e]:null})));else try{const s=await I.Ay.getDecryptedPassword(r);y((r=>({...r,[e]:s})))}catch(s){console.error("Decryption error:",s),g("Failed to decrypt password")}})(i,o.encryptedPassword)},color:"primary",sx:{p:.5,"&:hover":{bgcolor:"primary.light",color:"primary.contrastText"}},disabled:!S(o),children:d?(0,w.jsx)(k.A,{fontSize:"small"}):(0,w.jsx)(D.A,{fontSize:"small"})}),(0,w.jsx)(W.A,{size:"small",onClick:()=>{return e=o.password,navigator.clipboard.writeText(e),void P("Copied to clipboard");var e},color:"primary",sx:{p:.5,"&:hover":{bgcolor:"primary.light",color:"primary.contrastText"},"&.Mui-disabled":{opacity:.5}},disabled:!S(o),title:S(o)?"Copy password":"You don't have permission to copy this password",children:(0,w.jsx)(N,{fontSize:"small"})}),(0,w.jsx)(W.A,{size:"small",onClick:()=>(e=>{p(e),c(!0)})(o),color:"primary",sx:{p:.5,"&:hover":{bgcolor:"primary.light",color:"primary.contrastText"},"&.Mui-disabled":{opacity:.5}},title:C(o)?"Edit password":"Only owner and group admins can edit",disabled:!C(o),children:(0,w.jsx)(U.A,{fontSize:"small"})}),(0,w.jsx)(W.A,{size:"small",onClick:()=>{window.confirm("Are you sure you want to delete this password?")&&(async e=>{if(t)try{await t(e),P("Password entry deleted successfully"),setTimeout((()=>P("")),3e3)}catch(r){g((null===r||void 0===r?void 0:r.message)||"Failed to delete password entry"),setTimeout((()=>g("")),3e3)}else if(s)try{await I.Ay.deletePassword(e),s(),P("Password entry deleted successfully")}catch(r){console.error("Delete error:",r),g((null===r||void 0===r?void 0:r.message)||"Failed to delete password entry")}})(i)},color:"error",sx:{p:.5,"&:hover":{bgcolor:"error.light",color:"error.contrastText"},"&.Mui-disabled":{opacity:.5}},title:C(o)?"Delete password":"Only owner and group admins can delete",disabled:!C(o),children:(0,w.jsx)(M.A,{fontSize:"small"})})]})})]})};return i?(0,w.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,w.jsx)(O.A,{})}):(0,w.jsxs)(L.Ay,{container:!0,spacing:3,children:[(0,w.jsxs)(L.Ay,{item:!0,xs:12,children:[(0,w.jsx)(a.A,{variant:"h5",sx:{mb:3,color:"primary.main"},children:"Personal Passwords"}),0===z.personal.length?(0,w.jsx)(n.A,{sx:{textAlign:"center",py:6},children:(0,w.jsx)(a.A,{variant:"body1",color:"text.secondary",children:"No personal passwords yet. Create one to get started!"})}):(0,w.jsx)(L.Ay,{container:!0,spacing:3,children:z.personal.map((e=>(0,w.jsx)(L.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,w.jsx)(F,{entry:e})},`personal-${e._id||e.$id}`)))})]}),Object.entries(z.groups).map((e=>{let[r,s]=e;return(0,w.jsxs)(L.Ay,{item:!0,xs:12,children:[(0,w.jsxs)(a.A,{variant:"h5",sx:{mb:3,mt:4,color:"primary.main"},children:[s.name," Passwords"]}),(0,w.jsx)(L.Ay,{container:!0,spacing:3,children:s.entries.map((e=>(0,w.jsx)(L.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,w.jsx)(F,{entry:e})},`entry-${e._id||e.$id}`)))})]},`group-${r}`)})),(0,w.jsxs)(h.A,{open:l,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:1,boxShadow:3,bgcolor:"background.paper"}},children:[(0,w.jsx)(x.A,{sx:{pb:1,borderBottom:1,borderColor:"divider",bgcolor:"background.default"},children:"Edit Password Entry"}),(0,w.jsx)(v.A,{sx:{p:2},children:m&&(0,w.jsx)(B,{entry:m,onSubmit:async e=>{g("Edit feature coming soon"),c(!1)},onCancel:()=>c(!1)})})]}),(f||b)&&(0,w.jsxs)(n.A,{sx:{position:"fixed",bottom:16,right:16,zIndex:2e3,display:"flex",flexDirection:"column",gap:1},children:[f&&(0,w.jsx)(u.A,{severity:"error",variant:"filled",onClose:()=>g(""),sx:{minWidth:"250px",boxShadow:3},children:f}),b&&(0,w.jsx)(u.A,{severity:"success",variant:"filled",onClose:()=>P(""),sx:{minWidth:"250px",boxShadow:3},children:b})]})]})};var K=s(5721),Y=s(4628),V=s(8734),J=s(9347),Q=s(6649),Z=s(5626),ee=s(7132);const re=e=>{let{groups:r,onUpdate:s}=e;const{user:t}=(0,j.A)(),[i,d]=(0,o.useState)(!1),[l,m]=(0,o.useState)(!1),[p,A]=(0,o.useState)(null),[y,f]=(0,o.useState)(""),[g,b]=(0,o.useState)(""),[P,C]=(0,o.useState)(""),[S,I]=(0,o.useState)("");return(0,w.jsxs)(L.Ay,{container:!0,spacing:3,children:[0===r.length?(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(n.A,{sx:{textAlign:"center",py:4},children:(0,w.jsx)(a.A,{variant:"body1",color:"text.secondary",children:"No password groups yet. Create one to get started!"})})}):r.map((e=>(0,w.jsx)(L.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,w.jsxs)(T.A,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:1,boxShadow:2},children:[(0,w.jsxs)(R.A,{sx:{flexGrow:1,pb:1},children:[(0,w.jsx)(a.A,{variant:"h6",sx:{mb:1,fontWeight:"medium",color:"primary.main"},children:e.name}),e.description&&(0,w.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mb:2,overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.description}),(0,w.jsx)(a.A,{variant:"subtitle2",sx:{mb:1,fontWeight:"medium",color:"text.primary"},children:"Members:"}),(0,w.jsx)(K.A,{sx:{p:0},children:e.membersWithInfo&&Array.isArray(e.membersWithInfo)&&e.membersWithInfo.length>0?e.membersWithInfo.map(((r,o)=>{const t=r.nickname||r.name||r.email||"Unknown";return(0,w.jsxs)(Y.Ay,{sx:{px:0,py:.75,borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[(0,w.jsx)(V.A,{primary:t,secondary:r.nickname?`${r.name} (${r.email})`:r.email,primaryTypographyProps:{variant:"body2",fontWeight:"medium",sx:{mb:.25}},secondaryTypographyProps:{variant:"caption",color:"text.secondary"},sx:{mr:1}}),(0,w.jsx)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:e.membersWithInfo.length>1&&(0,w.jsx)(W.A,{size:"small",onClick:()=>(async(e,r)=>{try{await ee.default.removeMemberFromPasswordGroup(e,r),s(),b("Member removed successfully"),setTimeout((()=>b("")),3e3)}catch(o){f((null===o||void 0===o?void 0:o.message)||"Failed to remove member"),setTimeout((()=>f("")),5e3)}})(e.$id||e._id,r.userId),color:"error",sx:{p:.5},children:(0,w.jsx)(Q.A,{fontSize:"small"})})})]},`${e.$id||e._id}-${r.userId}-${o}`)})):(0,w.jsx)(a.A,{variant:"caption",color:"text.secondary",sx:{px:2,py:1},children:"No members yet"})})]}),(0,w.jsx)(E.A,{sx:{px:2,py:1,borderTop:1,borderColor:"divider"},children:(0,w.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,w.jsx)(W.A,{size:"small",onClick:()=>{A(e),m(!0)},color:"primary",sx:{p:.5},children:(0,w.jsx)(Z.A,{fontSize:"small"})}),(0,w.jsx)(W.A,{size:"small",onClick:()=>(e=>{A(e),d(!0)})(e),color:"primary",sx:{p:.5},children:(0,w.jsx)(U.A,{fontSize:"small"})}),(0,w.jsx)(W.A,{size:"small",onClick:()=>(async e=>{try{await ee.default.deletePasswordGroup(e),s(),b("Password group deleted successfully"),setTimeout((()=>b("")),3e3)}catch(r){f((null===r||void 0===r?void 0:r.message)||"Failed to delete password group"),setTimeout((()=>f("")),5e3)}})(e.$id||e._id),color:"error",sx:{p:.5},children:(0,w.jsx)(M.A,{fontSize:"small"})})]})})]})},e.$id||e._id))),(0,w.jsxs)(h.A,{open:l,onClose:()=>{m(!1),C(""),I("")},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:1,boxShadow:3}},children:[(0,w.jsx)(x.A,{sx:{pb:1},children:"Add Member to Group"}),(0,w.jsxs)(v.A,{children:[(0,w.jsx)(z.A,{autoFocus:!0,margin:"dense",label:"Email Address",type:"email",fullWidth:!0,value:P,onChange:e=>C(e.target.value),size:"small",required:!0,sx:{mt:2,mb:2,"& .MuiOutlinedInput-root":{borderRadius:1}}}),(0,w.jsx)(z.A,{margin:"dense",label:"Nickname (Optional)",fullWidth:!0,value:S,onChange:e=>I(e.target.value),size:"small",placeholder:"Enter a nickname for this member",helperText:"Leave empty to use their name",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})]}),(0,w.jsxs)(J.A,{sx:{px:3,pb:2},children:[(0,w.jsx)(c.A,{onClick:()=>{m(!1),C(""),I("")},size:"small",sx:{textTransform:"none",fontWeight:"medium"},children:"Cancel"}),(0,w.jsx)(c.A,{onClick:async()=>{if(!P.trim())return f("Please enter an email address"),void setTimeout((()=>f("")),3e3);try{await ee.default.addMemberToPasswordGroup(p.$id||p._id,P.trim(),S.trim()),s(),m(!1),C(""),I(""),b("Member added successfully"),setTimeout((()=>b("")),3e3)}catch(e){f((null===e||void 0===e?void 0:e.message)||"Failed to add member"),setTimeout((()=>f("")),5e3)}},variant:"contained",size:"small",disabled:!P.trim(),sx:{textTransform:"none",fontWeight:"medium"},children:"Add Member"})]})]}),(y||g)&&(0,w.jsxs)(n.A,{sx:{position:"fixed",bottom:16,right:16,zIndex:2e3,display:"flex",flexDirection:"column",gap:1},children:[y&&(0,w.jsx)(u.A,{severity:"error",variant:"filled",onClose:()=>f(""),sx:{minWidth:"250px",boxShadow:3},children:y}),g&&(0,w.jsx)(u.A,{severity:"success",variant:"filled",onClose:()=>b(""),sx:{minWidth:"250px",boxShadow:3},children:g})]})]})},se=e=>{let{group:r,onSubmit:s,onCancel:t}=e;const[a,i]=(0,o.useState)({name:"",description:""});(0,o.useEffect)((()=>{r&&i({name:r.name,description:r.description||""})}),[r]);const d=e=>{i({...a,[e.target.name]:e.target.value})};return(0,w.jsx)(n.A,{component:"form",onSubmit:e=>{e.preventDefault(),s(a)},sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:(0,w.jsxs)(L.Ay,{container:!0,spacing:2,children:[(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Group Name",name:"name",value:a.name,onChange:d,required:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsx)(z.A,{fullWidth:!0,label:"Description",name:"description",multiline:!0,rows:3,value:a.description,onChange:d,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,w.jsx)(L.Ay,{item:!0,xs:12,children:(0,w.jsxs)(n.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1,mt:1},children:[(0,w.jsx)(c.A,{onClick:t,size:"small",sx:{textTransform:"none",fontWeight:"medium"},children:"Cancel"}),(0,w.jsxs)(c.A,{type:"submit",variant:"contained",size:"small",sx:{textTransform:"none",fontWeight:"medium"},children:[r?"Update":"Create"," Group"]})]})})]})})};var oe=s(3336),te=s(1007);const ne=e=>{let{onAccess:r,requireSecondPassword:s,onSetupComplete:t,showSetup:i,onSetupCancel:d}=e;const[l,m]=(0,o.useState)(""),[p,A]=(0,o.useState)(""),[y,f]=(0,o.useState)(0),[g,j]=(0,o.useState)(!1),[P,C]=(0,o.useState)(0),[S,I]=(0,o.useState)(""),[T,_]=(0,o.useState)("");(0,o.useEffect)((()=>{const e=localStorage.getItem("pmLockedUntil");e&&parseInt(e)>Date.now()&&(j(!0),R(parseInt(e)))}),[]);const R=e=>{const r=()=>{const s=Math.ceil((e-Date.now())/1e3);s<=0?(j(!1),C(0),localStorage.removeItem("pmLockedUntil")):(C(s),setTimeout(r,1e3))};r()},E=()=>{const e=y+1;if(f(e),A("Incorrect password"),e>=3){const e=3e5,r=Date.now()+e;j(!0),localStorage.setItem("pmLockedUntil",r.toString()),R(r)}},W=async e=>{if(e.preventDefault(),S===T)try{await b.A.post("/api/passwords/second-password/settings",{requireSecondPassword:!0,secondPassword:S}),I(""),_(""),t()}catch(o){var r,s;A((null===(r=o.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||"Failed to set up second password")}else A("Passwords do not match")};return i?(0,w.jsxs)(h.A,{open:!0,maxWidth:"sm",fullWidth:!0,children:[(0,w.jsx)(x.A,{children:"Set Up Second Password"}),(0,w.jsx)(v.A,{children:(0,w.jsxs)(n.A,{component:"form",onSubmit:W,sx:{mt:2},children:[(0,w.jsx)(z.A,{fullWidth:!0,type:"password",label:"New Password",value:S,onChange:e=>I(e.target.value),required:!0,margin:"normal",autoFocus:!0}),(0,w.jsx)(z.A,{fullWidth:!0,type:"password",label:"Confirm Password",value:T,onChange:e=>_(e.target.value),required:!0,margin:"normal"}),p&&(0,w.jsx)(u.A,{severity:"error",sx:{mt:2},children:p}),(0,w.jsxs)(J.A,{sx:{mt:2,px:0},children:[(0,w.jsx)(c.A,{onClick:d,children:"Cancel"}),(0,w.jsx)(c.A,{onClick:W,variant:"contained",color:"primary",children:"Save"})]})]})})]}):s?(0,w.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh",bgcolor:"background.default"},children:(0,w.jsxs)(oe.A,{elevation:3,sx:{p:4,display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400,width:"100%",borderRadius:2,boxShadow:e=>e.shadows[8]},children:[(0,w.jsxs)(n.A,{sx:{textAlign:"center",mb:3},children:[(0,w.jsx)(te.A,{sx:{fontSize:40,color:"primary.main"}}),(0,w.jsx)(a.A,{variant:"h5",sx:{mt:2},children:"Password Manager Access"}),(0,w.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This is an additional security layer that you've enabled. You can disable it using the toggle switch after logging in."})]}),p&&(0,w.jsx)(u.A,{severity:"error",variant:"outlined",sx:{mb:2,width:"100%","& .MuiAlert-message":{width:"100%"}},children:p}),g?(0,w.jsxs)(u.A,{severity:"warning",variant:"outlined",sx:{mb:2,width:"100%","& .MuiAlert-message":{width:"100%"}},children:["Too many failed attempts. Please try again in ",P," seconds."]}):(0,w.jsxs)(n.A,{component:"form",onSubmit:async e=>{e.preventDefault();try{(await b.A.post("/api/passwords/second-password/verify",{password:l})).data.valid?(f(0),localStorage.removeItem("pmLockedUntil"),r()):E()}catch(t){var s,o;A((null===(s=t.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"Verification failed"),E()}m("")},sx:{width:"100%",display:"flex",flexDirection:"column",gap:2},children:[(0,w.jsx)(z.A,{fullWidth:!0,type:"password",label:"Password",value:l,onChange:e=>m(e.target.value),disabled:g,required:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}}),(0,w.jsx)(c.A,{fullWidth:!0,type:"submit",variant:"contained",disabled:g,sx:{py:1,textTransform:"none",borderRadius:1,fontWeight:"medium"},children:"Access Password Manager"})]})]})}):null},ae=()=>{const{user:e}=(0,j.A)(),[r,A]=(0,o.useState)(!1),[T,_]=(0,o.useState)(!1),[R,E]=(0,o.useState)(!1),[W,O]=(0,o.useState)(0),[L,k]=(0,o.useState)(""),[D,N]=(0,o.useState)(""),[U,M]=(0,o.useState)(!1),[z,F]=(0,o.useState)(!1),$=(0,o.useRef)(null);(0,o.useEffect)((()=>{_(!1),A(!0)}),[]);const G=(0,C.jE)(),{data:q=[],isLoading:X}=(K=r&&null!==e&&void 0!==e&&e.$id?e.$id:null,(0,P.I)({queryKey:["passwords",K],queryFn:async()=>await I.Ay.listPasswords(K),enabled:!!K,staleTime:6e5}));var K;const{data:Y=[],isLoading:V}=(e=>(0,P.I)({queryKey:["passwordGroups",e],queryFn:async()=>{const r=(await Promise.resolve().then(s.bind(s,7132))).default;return await r.listPasswordGroups(e)},enabled:!!e,staleTime:6e5}))(r&&null!==e&&void 0!==e&&e.$id?e.$id:null),J=(()=>{const e=(0,C.jE)();return(0,S.n)({mutationFn:async e=>{let{userId:r,passwordData:s}=e;return await I.Ay.createPassword(r,s)},onSuccess:(r,s)=>{e.invalidateQueries(["passwords",s.userId])}})})(),Q=(()=>{const e=(0,C.jE)();return(0,S.n)({mutationFn:async e=>{let{passwordId:r,userId:s}=e;return await I.Ay.deletePassword(r)},onSuccess:(r,s)=>{e.invalidateQueries(["passwords",s.userId])}})})(),Z=()=>{E(!1),_(!0),A(!1),N("Second password requirement enabled")},ee=()=>{E(!1),_(!1)},oe=()=>{A(!0)};return!r&&T?(0,w.jsx)(t.A,{maxWidth:"sm",children:(0,w.jsx)(ne,{onAccess:oe,requireSecondPassword:T,onSetupComplete:Z,showSetup:R,onSetupCancel:ee})}):(0,w.jsxs)(t.A,{maxWidth:"lg",children:[(0,w.jsxs)(n.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,w.jsx)(a.A,{variant:"h4",children:"Password Manager"}),(0,w.jsxs)(i.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,w.jsx)(d.A,{control:(0,w.jsx)(l.A,{checked:T,onChange:async e=>{const r=e.target.checked;try{r?(E(!0),_(!0)):(await b.A.post("/api/passwords/second-password/settings",{requireSecondPassword:!1}),_(!1),A(!0),N("Second password requirement disabled"))}catch(t){var s,o;k((null===(s=t.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"Failed to update settings"),_(!r)}},color:"primary"}),label:"Require Second Password"}),(0,w.jsx)("input",{type:"file",accept:".csv,.json",style:{display:"none"},ref:$,onChange:async r=>{try{k(""),N("");const s=r.target.files[0];if(!s)return;const o="text/csv"===s.type||s.name.endsWith(".csv"),t="application/json"===s.type||s.name.endsWith(".json");if(!o&&!t)return void k("Please select a valid CSV or JSON file");if(s.size>5242880)return void k("File size exceeds 5MB limit");const n=new FileReader;n.onload=async r=>{let s;const t=o?"csv":"json";if("json"===t){try{s=JSON.parse(r.target.result)}catch(d){return void k("Invalid JSON format in the imported file")}if(!Array.isArray(s))return void k("Invalid file format: content must be an array of passwords")}else s=r.target.result;try{const r=await b.A.post("/api/passwords/import",{format:t,data:s},{headers:{"Content-Type":"application/json"}});N(r.data.msg),G.invalidateQueries(["passwords",null===e||void 0===e?void 0:e.$id])}catch(l){var n,a,i;if(429===(null===(n=l.response)||void 0===n?void 0:n.status))k("Too many import attempts. Please try again later.");else k((null===(a=l.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.msg)||"Failed to import passwords");console.error("Import error:",l)}},n.onerror=()=>{k("Failed to read the file")},n.readAsText(s)}catch(s){k("Failed to process the import file"),console.error("Import error:",s)}finally{$.current&&($.current.value="")}}}),(0,w.jsx)(c.A,{variant:"outlined",startIcon:(0,w.jsx)(y,{}),onClick:()=>{var e;return null===(e=$.current)||void 0===e?void 0:e.click()},children:"Import"}),(0,w.jsx)(c.A,{variant:"outlined",startIcon:(0,w.jsx)(f,{}),onClick:async()=>{try{k(""),N("");const e="csv",r=await b.A.get(`/api/passwords/export?format=${e}`,{responseType:"csv"===e?"blob":"json"});if("csv"===e){const e=new Blob([r.data],{type:"text/csv"}),s=window.URL.createObjectURL(e),o=document.createElement("a");return o.href=s,o.download=`passwords-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(s),document.body.removeChild(o),void N("Passwords exported successfully")}const{data:s,count:t,message:n}=r.data;if(!s||!Array.isArray(s))return void k("Invalid response format from server");if(0===t)return void k("No passwords available to export");const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"});try{const e=window.URL.createObjectURL(a),r=document.createElement("a");r.href=e,r.download=`passwords-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(e),document.body.removeChild(r)}catch(o){return console.error("Download error:",o),void k("Failed to download the exported file")}N(n||`Successfully exported ${t} passwords`)}catch(t){var e,r,s;if(console.error("Export error:",t),429===(null===(e=t.response)||void 0===e?void 0:e.status))k("Too many export attempts. Please try again later.");else k((null===(r=t.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||"Failed to export passwords")}},children:"Export"})]})]}),R&&(0,w.jsx)(ne,{onAccess:oe,requireSecondPassword:T,onSetupComplete:Z,showSetup:R,onSetupCancel:ee}),L&&(0,w.jsx)(u.A,{severity:"error",variant:"outlined",sx:{mb:2},onClose:()=>k(""),children:L}),D&&(0,w.jsx)(u.A,{severity:"success",variant:"outlined",sx:{mb:2},onClose:()=>N(""),children:D}),(0,w.jsx)(n.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,w.jsxs)(m.A,{value:W,onChange:(e,r)=>{O(r)},sx:{"& .MuiTab-root":{textTransform:"none",fontSize:"0.95rem",minHeight:48,py:0}},children:[(0,w.jsx)(p.A,{label:"My Passwords"}),(0,w.jsx)(p.A,{label:"Password Groups"})]})}),(0,w.jsx)(n.A,{sx:{mb:2},children:0===W?(0,w.jsx)(c.A,{variant:"contained",startIcon:(0,w.jsx)(g.A,{}),onClick:()=>M(!0),children:"Add Password"}):(0,w.jsx)(c.A,{variant:"contained",startIcon:(0,w.jsx)(g.A,{}),onClick:()=>F(!0),children:"Create Group"})}),0===W?(0,w.jsx)(H,{entries:q,isLoading:X,onDelete:async r=>{try{await Q.mutateAsync({passwordId:r,userId:e.$id}),N("Password deleted successfully")}catch(s){k("Failed to delete password")}}}):(0,w.jsx)(re,{groups:Y,isLoading:V,onUpdate:()=>G.invalidateQueries(["passwordGroups",null===e||void 0===e?void 0:e.$id])}),(0,w.jsxs)(h.A,{open:U,onClose:()=>M(!1),maxWidth:"sm",fullWidth:!0,children:[(0,w.jsx)(x.A,{children:"Add Password Entry"}),(0,w.jsx)(v.A,{children:(0,w.jsx)(B,{groups:Y,onSubmit:async r=>{if(null!==e&&void 0!==e&&e.$id)try{await J.mutateAsync({userId:e.$id,passwordData:r}),M(!1),N("Password entry created successfully"),k("")}catch(o){var s;console.error("Create password error:",o);const e=(null===o||void 0===o?void 0:o.message)||(null===o||void 0===o||null===(s=o.response)||void 0===s?void 0:s.message)||(null===o||void 0===o?void 0:o.type)||"Failed to create password entry";k(`Error: ${e}. Check console for details.`)}else k("Not authenticated")},onCancel:()=>M(!1)})})]}),(0,w.jsxs)(h.A,{open:z,onClose:()=>F(!1),maxWidth:"sm",fullWidth:!0,children:[(0,w.jsx)(x.A,{children:"Create Password Group"}),(0,w.jsx)(v.A,{children:(0,w.jsx)(se,{onSubmit:async r=>{if(null!==e&&void 0!==e&&e.$id)try{const o=(await Promise.resolve().then(s.bind(s,7132))).default;await o.createPasswordGroup(e.$id,r),G.invalidateQueries(["passwordGroups",e.$id]),N("Password group created successfully"),k(""),F(!1)}catch(o){console.error("Create password group error:",o),k((null===o||void 0===o?void 0:o.message)||"Failed to create password group")}else k("Not authenticated")},onCancel:()=>F(!1)})})]})]})}},5626:(e,r,s)=>{"use strict";s.d(r,{A:()=>n});var o=s(9662),t=s(579);const n=(0,o.A)((0,t.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},6305:()=>{},6494:(e,r,s)=>{"use strict";s.d(r,{A:()=>v});var o=s(8168),t=s(8587),n=s(5043),a=s(8387),i=s(5049),d=s(4535),l=s(2876),c=s(4987),u=s(239);function m(e){return(0,u.Ay)("MuiCardContent",e)}(0,c.A)("MuiCardContent",["root"]);var p=s(579);const h=["className","component"],x=(0,d.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,r)=>r.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),v=n.forwardRef((function(e,r){const s=(0,l.A)({props:e,name:"MuiCardContent"}),{className:n,component:d="div"}=s,c=(0,t.A)(s,h),u=(0,o.A)({},s,{component:d}),v=(e=>{const{classes:r}=e;return(0,i.A)({root:["root"]},m,r)})(u);return(0,p.jsx)(x,(0,o.A)({as:d,className:(0,a.A)(v.root,n),ownerState:u,ref:r},c))}))},6649:(e,r,s)=>{"use strict";s.d(r,{A:()=>n});var o=s(9662),t=s(579);const n=(0,o.A)((0,t.jsx)("path",{d:"M14 8c0-2.21-1.79-4-4-4S6 5.79 6 8s1.79 4 4 4 4-1.79 4-4m3 2v2h6v-2zM2 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4"}),"PersonRemove")},7132:(e,r,s)=>{"use strict";s.r(r),s.d(r,{addMemberToPasswordGroup:()=>l,createPasswordGroup:()=>d,default:()=>m,deletePasswordGroup:()=>u,listPasswordGroups:()=>i,removeMemberFromPasswordGroup:()=>c});var o=s(5404),t=s(5460);const n="69181c670024df0dd32b",a={NODE_ENV:"production",PUBLIC_URL:"/-note-sharing-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://note-sharing-app.onrender.com",REACT_APP_APPWRITE_COLLECTION_GROUPS:"6918f637002e49bd5482",REACT_APP_APPWRITE_COLLECTION_NOTES:"6918f63400264192256d",REACT_APP_APPWRITE_COLLECTION_PASSWORDS:"6918f63900228f33e93c",REACT_APP_APPWRITE_COLLECTION_PROFILES:"6918f632002d42536ab2",REACT_APP_APPWRITE_DATABASE_ID:"69181c670024df0dd32b",REACT_APP_APPWRITE_ENDPOINT:"https://nyc.cloud.appwrite.io/v1",REACT_APP_APPWRITE_PROJECT:"691815b8003ae6a0e161",REACT_APP_ENCRYPTION_KEY:"AumLB6URqqyU5pUr3MNCTsEDlBIeQUaCOVBIyYYBl/U="}.REACT_APP_APPWRITE_COLLECTION_PASSWORD_GROUPS||"6918f637002e49bd5482";async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const r=[];r.push(t.XK.equal("type","password")),e&&r.push(t.XK.equal("ownerId",e));const s=(await o.LL.listDocuments(n,a,r)).documents||[],i="6918f632002d42536ab2";return await Promise.all(s.map((async e=>{if(!e.members||!Array.isArray(e.members))return{...e,membersWithInfo:[]};let r={};try{r=e.memberNicknames?JSON.parse(e.memberNicknames):{}}catch(a){r={}}const s=await Promise.all(e.members.map((async e=>{try{const s=await o.LL.listDocuments(n,i,[t.XK.equal("userId",e)]);if(s.documents&&s.documents.length>0){const o=s.documents[0];return{userId:e,name:o.name||o.email||"Unknown",email:o.email||"",nickname:r[e]||""}}return{userId:e,name:"Unknown User",email:"",nickname:r[e]||""}}catch(s){return console.warn(`Failed to fetch profile for ${e}:`,s),{userId:e,name:"Unknown User",email:"",nickname:r[e]||""}}})));return{...e,membersWithInfo:s}})))}catch(r){return console.warn("Failed to fetch password groups:",r),[]}}async function d(e,r){try{const{name:s,description:i}=r;if(!s)throw new Error("Group name is required");const d=[t.aX.read(t.Xh.user(e)),t.aX.update(t.Xh.user(e)),t.aX.delete(t.Xh.user(e)),t.aX.read(t.Xh.users())];return await o.LL.createDocument(n,a,t.ID.unique(),{ownerId:e,name:s.trim(),description:i||"",members:[],memberNicknames:"{}",type:"password"},d)}catch(s){throw console.error("Failed to create password group:",s),s}}async function l(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const d=await o.LL.getDocument(n,a,e),l="6918f632002d42536ab2",c=await o.LL.listDocuments(n,l,[t.XK.equal("email",r.toLowerCase())]);if(!c.documents||0===c.documents.length)throw new Error("User not found with that email");const u=c.documents[0].userId,m=d.members||[];let p={};try{p=d.memberNicknames?JSON.parse(d.memberNicknames):{}}catch(i){p={}}if(m.includes(u))throw new Error("User is already a member of this group");const h=[...m,u];s.trim()&&(p[u]=s.trim());const x=[t.aX.read(t.Xh.user(d.ownerId)),t.aX.update(t.Xh.user(d.ownerId)),t.aX.delete(t.Xh.user(d.ownerId)),t.aX.read(t.Xh.users())];return await o.LL.updateDocument(n,a,e,{members:h,memberNicknames:JSON.stringify(p)},x)}catch(d){throw console.error("Failed to add member:",d),d}}async function c(e,r){try{const i=await o.LL.getDocument(n,a,e),d=(i.members||[]).filter((e=>e!==r));let l={};try{l=i.memberNicknames?JSON.parse(i.memberNicknames):{}}catch(s){l={}}delete l[r];const c=[t.aX.read(t.Xh.user(i.ownerId)),t.aX.update(t.Xh.user(i.ownerId)),t.aX.delete(t.Xh.user(i.ownerId)),t.aX.read(t.Xh.users())];return await o.LL.updateDocument(n,a,e,{members:d,memberNicknames:JSON.stringify(l)},c)}catch(i){throw console.error("Failed to remove member:",i),i}}async function u(e){try{return await o.LL.deleteDocument(n,a,e)}catch(r){throw console.error("Failed to delete password group:",r),r}}const m={listPasswordGroups:i,createPasswordGroup:d,addMemberToPasswordGroup:l,removeMemberFromPasswordGroup:c,deletePasswordGroup:u}},7600:(e,r,s)=>{"use strict";s.d(r,{A:()=>v});var o=s(8587),t=s(8168),n=s(5043),a=s(8387),i=s(5049),d=s(4535),l=s(2876),c=s(4987),u=s(239);function m(e){return(0,u.Ay)("MuiCardActions",e)}(0,c.A)("MuiCardActions",["root","spacing"]);var p=s(579);const h=["disableSpacing","className"],x=(0,d.Ay)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,!s.disableSpacing&&r.spacing]}})((e=>{let{ownerState:r}=e;return(0,t.A)({display:"flex",alignItems:"center",padding:8},!r.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})})),v=n.forwardRef((function(e,r){const s=(0,l.A)({props:e,name:"MuiCardActions"}),{disableSpacing:n=!1,className:d}=s,c=(0,o.A)(s,h),u=(0,t.A)({},s,{disableSpacing:n}),v=(e=>{const{classes:r,disableSpacing:s}=e,o={root:["root",!s&&"spacing"]};return(0,i.A)(o,m,r)})(u);return(0,p.jsx)(x,(0,t.A)({className:(0,a.A)(v.root,d),ownerState:u,ref:r},c))}))}}]);
//# sourceMappingURL=325.e6882a64.chunk.js.map