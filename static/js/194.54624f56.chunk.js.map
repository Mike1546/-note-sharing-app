{"version":3,"file":"static/js/194.54624f56.chunk.js","mappings":"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","sources":["api/axios.js","hooks/useGroups.js","services/db.js","services/groups.js","components/notes/NoteEditor.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Determine if we're accessing through Twingate by checking the hostname\r\nconst isTwingate = window.location.hostname.includes('100.127.255');\r\n\r\n// Use the appropriate base URL\r\n// For local development, use localhost:5000, otherwise use the configured URL\r\nconst isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\r\nconst baseURL = isTwingate \r\n  ? process.env.REACT_APP_TWINGATE_API_URL \r\n  : isLocalhost\r\n    ? 'http://localhost:5000'\r\n    : process.env.REACT_APP_API_URL;\r\n\r\n// Log the base URL for debugging\r\nconsole.log('API Base URL:', baseURL);\r\n\r\nconst api = axios.create({\r\n  baseURL,\r\n  withCredentials: true,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Add request interceptor for error handling\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // Get token from localStorage if it exists\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add response interceptor for error handling\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      // Handle unauthorized access\r\n      localStorage.removeItem('token');\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api; ","import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport groupsService from '../services/groups';\r\n\r\nexport const useGroups = (userId) => {\r\n  return useQuery({\r\n    queryKey: ['groups', userId],\r\n    queryFn: async () => {\r\n      const groups = await groupsService.listGroups(userId);\r\n      return groups.map((g) => ({\r\n        _id: g.$id,\r\n        name: g.name || '',\r\n        description: g.description || '',\r\n        members: g.members || [],\r\n        membersWithInfo: g.membersWithInfo || [],\r\n        memberNicknames: g.memberNicknames || {},\r\n        ownerId: g.ownerId,\r\n      }));\r\n    },\r\n    enabled: !!userId,\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n  });\r\n};\r\n\r\nexport const useCreateGroup = () => {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async ({ userId, groupData }) => {\r\n      return await groupsService.createGroup(userId, groupData);\r\n    },\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries(['groups', variables.userId]);\r\n    },\r\n  });\r\n};\r\n\r\nexport const useDeleteGroup = () => {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async ({ groupId, userId }) => {\r\n      return await groupsService.deleteGroup(groupId);\r\n    },\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries(['groups', variables.userId]);\r\n    },\r\n  });\r\n};\r\n\r\n","import { databases } from '../appwrite';\r\nimport { Query, Permission, Role } from 'appwrite';\r\n\r\nconst DATABASE_ID = process.env.REACT_APP_APPWRITE_DATABASE_ID || 'YOUR_DATABASE_ID';\r\nconst NOTES_COLLECTION_ID = process.env.REACT_APP_APPWRITE_COLLECTION_NOTES || 'YOUR_NOTES_COLLECTION_ID';\r\n\r\n/**\r\n * Create a note belonging to a user.\r\n * @param {string} userId - Appwrite user id (account.$id)\r\n * @param {object} note - { title, content, groupId?, pinned?, ... }\r\n */\r\nexport async function createNote(userId, note) {\r\n  const permissions = [\r\n    Permission.read(Role.user(userId)),\r\n    Permission.update(Role.user(userId)),\r\n    Permission.delete(Role.user(userId)),\r\n    Permission.write(Role.user(userId)),\r\n  ];\r\n  try {\r\n    return await databases.createDocument(\r\n      DATABASE_ID,\r\n      NOTES_COLLECTION_ID,\r\n      'unique()',\r\n      { ...note, ownerId: userId },\r\n      permissions\r\n    );\r\n  } catch (err) {\r\n    const msg = err?.message || err?.response?.message || '';\r\n    const code = err?.code || err?.response?.code;\r\n    // If collection is using collection-level permissions, Appwrite rejects the permissions param\r\n    if (String(msg).toLowerCase().includes('permissions') || code === 400) {\r\n      // Retry without explicit document permissions\r\n      return databases.createDocument(\r\n        DATABASE_ID,\r\n        NOTES_COLLECTION_ID,\r\n        'unique()',\r\n        { ...note, ownerId: userId }\r\n      );\r\n    }\r\n    throw err;\r\n  }\r\n}\r\n\r\n/**\r\n * List notes for a user.\r\n * @param {string} userId\r\n */\r\nexport async function listNotes(userId) {\r\n  try {\r\n    const response = await databases.listDocuments(\r\n      DATABASE_ID,\r\n      NOTES_COLLECTION_ID,\r\n      [Query.equal('ownerId', userId)]\r\n    );\r\n    const notes = response.documents || [];\r\n    \r\n    // Enrich notes with owner profile information\r\n    const PROFILES_COLLECTION_ID = process.env.REACT_APP_APPWRITE_COLLECTION_PROFILES || '6918f632002d42536ab2';\r\n    const enrichedNotes = await Promise.all(notes.map(async (note) => {\r\n      if (!note.ownerId) {\r\n        return note;\r\n      }\r\n      \r\n      try {\r\n        const profiles = await databases.listDocuments(\r\n          DATABASE_ID,\r\n          PROFILES_COLLECTION_ID,\r\n          [Query.equal('userId', note.ownerId)]\r\n        );\r\n        \r\n        if (profiles.documents && profiles.documents.length > 0) {\r\n          const profile = profiles.documents[0];\r\n          return {\r\n            ...note,\r\n            owner: {\r\n              name: profile.name || profile.email || 'Unknown',\r\n              email: profile.email || ''\r\n            }\r\n          };\r\n        }\r\n        return {\r\n          ...note,\r\n          owner: {\r\n            name: 'Unknown User',\r\n            email: ''\r\n          }\r\n        };\r\n      } catch (err) {\r\n        console.warn(`Failed to fetch profile for owner ${note.ownerId}:`, err);\r\n        return {\r\n          ...note,\r\n          owner: {\r\n            name: 'Unknown User',\r\n            email: ''\r\n          }\r\n        };\r\n      }\r\n    }));\r\n    \r\n    return enrichedNotes;\r\n  } catch (err) {\r\n    // Fallback when the attribute isn't in schema yet\r\n    try {\r\n      const res = await databases.listDocuments(DATABASE_ID, NOTES_COLLECTION_ID);\r\n      res.documents = (res.documents || []).filter((d) => d.ownerId === userId);\r\n      return res;\r\n    } catch (e) {\r\n      throw err;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Update a note. Note owner should be used to set permissions.\r\n * @param {string} documentId\r\n * @param {string} userId\r\n * @param {object} data\r\n */\r\nexport async function updateNote(documentId, userId, data) {\r\n  return databases.updateDocument(\r\n    DATABASE_ID,\r\n    NOTES_COLLECTION_ID,\r\n    documentId,\r\n    data\r\n  );\r\n}\r\n\r\n/**\r\n * Delete a note document.\r\n * @param {string} documentId\r\n */\r\nexport async function deleteNote(documentId) {\r\n  return databases.deleteDocument(\r\n    DATABASE_ID,\r\n    NOTES_COLLECTION_ID,\r\n    documentId\r\n  );\r\n}\r\n\r\nexport default {\r\n  createNote,\r\n  listNotes,\r\n  updateNote,\r\n  deleteNote,\r\n};\r\n","import { databases } from '../appwrite';\r\nimport { Query, ID, Permission, Role } from 'appwrite';\r\n\r\nconst DATABASE_ID = process.env.REACT_APP_APPWRITE_DATABASE_ID || '69181c670024df0dd32b';\r\nconst GROUPS_COLLECTION_ID = process.env.REACT_APP_APPWRITE_COLLECTION_GROUPS || '6918f637002e49bd5482';\r\n\r\nexport async function listGroups(userId = null) {\r\n  try {\r\n    const queries = [];\r\n    // Filter by type='note' to distinguish from password groups\r\n    // Also include groups without type (for backward compatibility)\r\n    queries.push(Query.or([\r\n      Query.equal('type', 'note'),\r\n      Query.isNull('type')\r\n    ]));\r\n    if (userId) {\r\n      queries.push(Query.equal('ownerId', userId));\r\n    }\r\n    const res = await databases.listDocuments(DATABASE_ID, GROUPS_COLLECTION_ID, queries);\r\n    const groups = res.documents || [];\r\n    \r\n    // Enrich members with profile information\r\n    const PROFILES_COLLECTION_ID = process.env.REACT_APP_APPWRITE_COLLECTION_PROFILES || '6918f632002d42536ab2';\r\n    const enrichedGroups = await Promise.all(groups.map(async (group) => {\r\n      if (!group.members || !Array.isArray(group.members)) {\r\n        return { ...group, membersWithInfo: [] };\r\n      }\r\n      \r\n      // Parse member nicknames\r\n      let memberNicknames = {};\r\n      try {\r\n        memberNicknames = group.memberNicknames ? JSON.parse(group.memberNicknames) : {};\r\n      } catch (e) {\r\n        memberNicknames = {};\r\n      }\r\n      \r\n      // Fetch profiles for all member IDs\r\n      const memberProfiles = await Promise.all(\r\n        group.members.map(async (memberId) => {\r\n          try {\r\n            const profiles = await databases.listDocuments(\r\n              DATABASE_ID,\r\n              PROFILES_COLLECTION_ID,\r\n              [Query.equal('userId', memberId)]\r\n            );\r\n            \r\n            if (profiles.documents && profiles.documents.length > 0) {\r\n              const profile = profiles.documents[0];\r\n              return {\r\n                userId: memberId,\r\n                name: profile.name || profile.email || 'Unknown',\r\n                email: profile.email || '',\r\n                nickname: memberNicknames[memberId] || ''\r\n              };\r\n            }\r\n            return {\r\n              userId: memberId,\r\n              name: 'Unknown User',\r\n              email: '',\r\n              nickname: memberNicknames[memberId] || ''\r\n            };\r\n          } catch (err) {\r\n            console.warn(`Failed to fetch profile for ${memberId}:`, err);\r\n            return {\r\n              userId: memberId,\r\n              name: 'Unknown User',\r\n              email: '',\r\n              nickname: memberNicknames[memberId] || ''\r\n            };\r\n          }\r\n        })\r\n      );\r\n      \r\n      return { ...group, membersWithInfo: memberProfiles };\r\n    }));\r\n    \r\n    return enrichedGroups;\r\n  } catch (err) {\r\n    console.warn('Failed to fetch groups:', err);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createGroup(userId, groupData) {\r\n  try {\r\n    const { name, description } = groupData;\r\n    if (!name) {\r\n      throw new Error('Group name is required');\r\n    }\r\n    \r\n    // Set document permissions: owner can read/write, all users can read\r\n    const permissions = [\r\n      Permission.read(Role.user(userId)), // Owner can read\r\n      Permission.update(Role.user(userId)), // Owner can update\r\n      Permission.delete(Role.user(userId)), // Owner can delete\r\n      Permission.read(Role.users()) // All authenticated users can read (for listing)\r\n    ];\r\n    \r\n    const document = await databases.createDocument(\r\n      DATABASE_ID,\r\n      GROUPS_COLLECTION_ID,\r\n      ID.unique(),\r\n      {\r\n        ownerId: userId,\r\n        name: name.trim(),\r\n        description: description || '',\r\n        members: [], // Start with empty members array\r\n        memberNicknames: '{}', // JSON string for member nicknames\r\n        type: 'note' // Distinguish from password groups\r\n      },\r\n      permissions\r\n    );\r\n    return document;\r\n  } catch (err) {\r\n    console.error('Failed to create group:', err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport async function addMemberToGroup(groupId, userEmail, nickname = '') {\r\n  try {\r\n    // First, get the group\r\n    const group = await databases.getDocument(DATABASE_ID, GROUPS_COLLECTION_ID, groupId);\r\n    \r\n    // Find user by email from profiles\r\n    const PROFILES_COLLECTION_ID = process.env.REACT_APP_APPWRITE_COLLECTION_PROFILES || '6918f632002d42536ab2';\r\n    const profiles = await databases.listDocuments(\r\n      DATABASE_ID,\r\n      PROFILES_COLLECTION_ID,\r\n      [Query.equal('email', userEmail.toLowerCase())]\r\n    );\r\n    \r\n    if (!profiles.documents || profiles.documents.length === 0) {\r\n      throw new Error('User not found with that email');\r\n    }\r\n    \r\n    const userProfile = profiles.documents[0];\r\n    const userId = userProfile.userId;\r\n    \r\n    // Get current members (array of user IDs) and nicknames (JSON object)\r\n    const currentMembers = group.members || [];\r\n    let memberNicknames = {};\r\n    try {\r\n      memberNicknames = group.memberNicknames ? JSON.parse(group.memberNicknames) : {};\r\n    } catch (e) {\r\n      memberNicknames = {};\r\n    }\r\n    \r\n    // Check if user is already a member\r\n    if (currentMembers.includes(userId)) {\r\n      throw new Error('User is already a member of this group');\r\n    }\r\n    \r\n    // Add user ID to members array and nickname to nicknames object\r\n    const updatedMembers = [...currentMembers, userId];\r\n    if (nickname.trim()) {\r\n      memberNicknames[userId] = nickname.trim();\r\n    }\r\n    \r\n    // Update the group with proper permissions\r\n    const permissions = [\r\n      Permission.read(Role.user(group.ownerId)), // Owner can read\r\n      Permission.update(Role.user(group.ownerId)), // Owner can update\r\n      Permission.delete(Role.user(group.ownerId)), // Owner can delete\r\n      Permission.read(Role.users()) // All authenticated users can read\r\n    ];\r\n    \r\n    return await databases.updateDocument(\r\n      DATABASE_ID,\r\n      GROUPS_COLLECTION_ID,\r\n      groupId,\r\n      {\r\n        members: updatedMembers,\r\n        memberNicknames: JSON.stringify(memberNicknames)\r\n      },\r\n      permissions\r\n    );\r\n  } catch (err) {\r\n    console.error('Failed to add member:', err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport async function removeMemberFromGroup(groupId, userId) {\r\n  try {\r\n    const group = await databases.getDocument(DATABASE_ID, GROUPS_COLLECTION_ID, groupId);\r\n    const currentMembers = group.members || [];\r\n    const updatedMembers = currentMembers.filter(m => m !== userId);\r\n    \r\n    // Remove nickname if exists\r\n    let memberNicknames = {};\r\n    try {\r\n      memberNicknames = group.memberNicknames ? JSON.parse(group.memberNicknames) : {};\r\n    } catch (e) {\r\n      memberNicknames = {};\r\n    }\r\n    delete memberNicknames[userId];\r\n    \r\n    const permissions = [\r\n      Permission.read(Role.user(group.ownerId)),\r\n      Permission.update(Role.user(group.ownerId)),\r\n      Permission.delete(Role.user(group.ownerId)),\r\n      Permission.read(Role.users())\r\n    ];\r\n    \r\n    return await databases.updateDocument(\r\n      DATABASE_ID,\r\n      GROUPS_COLLECTION_ID,\r\n      groupId,\r\n      {\r\n        members: updatedMembers,\r\n        memberNicknames: JSON.stringify(memberNicknames)\r\n      },\r\n      permissions\r\n    );\r\n  } catch (err) {\r\n    console.error('Failed to remove member:', err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport async function deleteGroup(documentId) {\r\n  try {\r\n    return await databases.deleteDocument(DATABASE_ID, GROUPS_COLLECTION_ID, documentId);\r\n  } catch (err) {\r\n    console.error('Failed to delete group:', err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport default { listGroups, createGroup, addMemberToGroup, removeMemberFromGroup, deleteGroup };\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate, useLocation } from 'react-router-dom';\r\nimport {\r\n  Box,\r\n  TextField,\r\n  Button,\r\n  FormControlLabel,\r\n  Switch,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  IconButton,\r\n  Chip,\r\n  Stack,\r\n  Typography,\r\n  Alert,\r\n  Select,\r\n  MenuItem,\r\n  FormControl,\r\n  InputLabel\r\n} from '@mui/material';\r\nimport {\r\n  Save as SaveIcon,\r\n  Lock as LockIcon,\r\n  LockOpen as LockOpenIcon,\r\n  Add as AddIcon,\r\n  Home as HomeIcon,\r\n  Notes as NotesIcon,\r\n  CheckCircle as CheckCircleIcon\r\n} from '@mui/icons-material';\r\nimport Breadcrumbs from '@mui/material/Breadcrumbs';\r\nimport Link from '@mui/material/Link';\r\nimport api from '../../api/axios';\r\nimport groupsService from '../../services/groups';\r\nimport notesDb from '../../services/db';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useGroups } from '../../hooks/useGroups';\r\nimport dayjs from 'dayjs';\r\n\r\nconst NoteEditor = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { user } = useAuth();\r\n  const queryParams = new URLSearchParams(location.search);\r\n  const groupIdFromUrl = queryParams.get('groupId');\r\n\r\n  const [note, setNote] = useState({\r\n    title: '',\r\n    content: '',\r\n    isLocked: false,\r\n    lockPasscode: '',\r\n    isEncrypted: false,\r\n    tags: [],\r\n    groupId: groupIdFromUrl || ''\r\n  });\r\n  const [originalContent, setOriginalContent] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  // React Query for groups\r\n  const { data: groups = [] } = useGroups(user?.$id);\r\n  const [error, setError] = useState('');\r\n  const [passcodeDialogOpen, setPasscodeDialogOpen] = useState(false);\r\n  const [newTag, setNewTag] = useState('');\r\n  const [passcode, setPasscode] = useState('');\r\n  const [isNoteLocked, setIsNoteLocked] = useState(false);\r\n  const [passcodeAttempts, setPasscodeAttempts] = useState(0);\r\n  const [isSettingLockPasscode, setIsSettingLockPasscode] = useState(false);\r\n  const initialSnapshotRef = useRef(null);\r\n  const [isDirty, setIsDirty] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState(null);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const autoSaveTimerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (id && id !== 'new') {\r\n      fetchNote();\r\n    } else {\r\n      setLoading(false);\r\n      initialSnapshotRef.current = {\r\n        title: '',\r\n        content: '',\r\n        isLocked: false,\r\n        lockPasscode: '',\r\n        isEncrypted: false,\r\n        tags: [],\r\n        groupId: groupIdFromUrl || ''\r\n      };\r\n    }\r\n  }, [id]);\r\n\r\n  const fetchNote = async (providedPasscode = null) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        throw new Error('No authentication token found');\r\n      }\r\n\r\n      const config = {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      };\r\n\r\n      // First try to fetch the note metadata\r\n      const metadataResponse = await api.get(`/api/notes/${id}/metadata`, config);\r\n      const metadata = metadataResponse.data;\r\n      \r\n      setIsNoteLocked(metadata.isLocked);\r\n      \r\n      if (metadata.isLocked && !providedPasscode) {\r\n        setNote({\r\n          ...metadata,\r\n          content: 'ðŸ”’ This note is locked. Enter passcode to view.'\r\n        });\r\n        setPasscodeDialogOpen(true);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // If passcode is provided or note is not locked, fetch full content\r\n      let url = `/api/notes/${id}`;\r\n      if (providedPasscode) {\r\n        url += `?passcode=${encodeURIComponent(providedPasscode.trim())}`;\r\n      }\r\n\r\n      console.log('Fetching note with URL:', url);\r\n      const response = await api.get(url, config);\r\n      \r\n      if (response.data) {\r\n        const noteData = response.data;\r\n        setNote(noteData);\r\n        // Capture initial snapshot for unsaved-changes detection\r\n        initialSnapshotRef.current = {\r\n          title: noteData.title || '',\r\n          content: noteData.content || '',\r\n          isLocked: !!noteData.isLocked,\r\n          lockPasscode: noteData.lockPasscode || '',\r\n          isEncrypted: !!noteData.isEncrypted,\r\n          tags: Array.isArray(noteData.tags) ? noteData.tags : [],\r\n          groupId: noteData.groupId || ''\r\n        };\r\n        if (noteData.isLocked) {\r\n          setOriginalContent(noteData.content);\r\n        }\r\n        setPasscodeDialogOpen(false);\r\n        setPasscodeAttempts(0);\r\n        setError('');\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Note fetch error:', error.response?.status, error.response?.data);\r\n      if (error.response?.status === 401) {\r\n        setPasscodeAttempts(prev => {\r\n          const newAttempts = prev + 1;\r\n          if (newAttempts >= 3) {\r\n            setError('Too many incorrect attempts. Returning to dashboard.');\r\n            setTimeout(() => navigate('/'), 2000);\r\n          } else {\r\n            setError(`Invalid passcode. ${3 - newAttempts} attempts remaining.`);\r\n          }\r\n          return newAttempts;\r\n        });\r\n        setPasscode('');\r\n      } else {\r\n        setError(error.response?.data?.message || 'Error loading note');\r\n      }\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    // For groupId, convert empty string to null to avoid undefined\r\n    if (name === 'groupId') {\r\n      setNote(prev => ({\r\n        ...prev,\r\n        [name]: value || null\r\n      }));\r\n    } else {\r\n      setNote(prev => ({\r\n        ...prev,\r\n        [name]: value\r\n      }));\r\n    }\r\n  };\r\n\r\n  // Track unsaved changes (dirty state) and auto-save\r\n  useEffect(() => {\r\n    const base = initialSnapshotRef.current;\r\n    if (!base) {\r\n      setIsDirty(false);\r\n      return;\r\n    }\r\n    const current = {\r\n      title: note.title || '',\r\n      content: note.content || '',\r\n      isLocked: !!note.isLocked,\r\n      lockPasscode: note.lockPasscode || '',\r\n      isEncrypted: !!note.isEncrypted,\r\n      tags: Array.isArray(note.tags) ? note.tags : [],\r\n      groupId: note.groupId || ''\r\n    };\r\n    const dirty = JSON.stringify(base) !== JSON.stringify(current);\r\n    setIsDirty(dirty);\r\n    // expose globally so Layout can guard navigation\r\n    window.__unsavedChanges = dirty;\r\n\r\n    // Auto-save after 2 seconds of inactivity (only for existing notes)\r\n    if (dirty && id && id !== 'new' && !isNoteLocked) {\r\n      if (autoSaveTimerRef.current) {\r\n        clearTimeout(autoSaveTimerRef.current);\r\n      }\r\n      autoSaveTimerRef.current = setTimeout(async () => {\r\n        try {\r\n          setIsSaving(true);\r\n          const noteData = {\r\n            title: note.title,\r\n            content: note.content,\r\n            isLocked: note.isLocked,\r\n            lockPasscode: note.lockPasscode,\r\n            tags: note.tags,\r\n            isEncrypted: note.isEncrypted,\r\n            groupId: note.groupId || null\r\n          };\r\n          if (user?.$id) {\r\n            await notesDb.updateNote(id, user.$id, noteData);\r\n            setLastSaved(new Date());\r\n            setIsDirty(false);\r\n            window.__unsavedChanges = false;\r\n          }\r\n        } catch (err) {\r\n          console.error('Auto-save error:', err);\r\n        } finally {\r\n          setIsSaving(false);\r\n        }\r\n      }, 2000);\r\n    }\r\n\r\n    return () => {\r\n      if (autoSaveTimerRef.current) {\r\n        clearTimeout(autoSaveTimerRef.current);\r\n      }\r\n    };\r\n  }, [note, id, isNoteLocked, user?.$id]);\r\n\r\n  // Warn on browser refresh/close when dirty\r\n  useEffect(() => {\r\n    const beforeUnload = (e) => {\r\n      if (!isDirty) return;\r\n      e.preventDefault();\r\n      e.returnValue = '';\r\n    };\r\n    window.addEventListener('beforeunload', beforeUnload);\r\n    return () => window.removeEventListener('beforeunload', beforeUnload);\r\n  }, [isDirty]);\r\n\r\n  const handleToggleLock = () => {\r\n    if (!note.isLocked) {\r\n      // Store the current content before showing the passcode dialog\r\n      setOriginalContent(note.content);\r\n      setIsSettingLockPasscode(true);\r\n      setPasscodeDialogOpen(true);\r\n    } else {\r\n      // Unlocking the note - restore the original content\r\n      setNote({\r\n        ...note,\r\n        isLocked: false,\r\n        lockPasscode: '',\r\n        content: originalContent || note.content\r\n      });\r\n      setOriginalContent('');\r\n      setIsNoteLocked(false);\r\n    }\r\n  };\r\n\r\n  const handlePasscodeSubmit = async () => {\r\n    try {\r\n      if (isSettingLockPasscode) {\r\n        // Locking the note - just set the lock state but don't change content yet\r\n        setNote({\r\n          ...note,\r\n          isLocked: true,\r\n          lockPasscode: passcode\r\n        });\r\n        setIsNoteLocked(true);\r\n        setIsSettingLockPasscode(false);\r\n        setPasscodeDialogOpen(false);\r\n      } else if (id && id !== 'new') {\r\n        // Unlocking the note\r\n        await fetchNote(passcode);\r\n      }\r\n      setPasscode('');\r\n      setError('');\r\n    } catch (error) {\r\n      console.error('Passcode submission error:', error);\r\n      setError(error.response?.data?.message || 'Error submitting passcode');\r\n    }\r\n  };\r\n\r\n  const handleAddTag = () => {\r\n    if (newTag.trim() && !note.tags.includes(newTag.trim())) {\r\n      setNote({\r\n        ...note,\r\n        tags: [...note.tags, newTag.trim()]\r\n      });\r\n      setNewTag('');\r\n    }\r\n  };\r\n\r\n  const handleDeleteTag = (tagToDelete) => {\r\n    setNote({\r\n      ...note,\r\n      tags: note.tags.filter(tag => tag !== tagToDelete)\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const noteData = {\r\n        title: note.title,\r\n        content: note.content,\r\n        isLocked: note.isLocked,\r\n        lockPasscode: note.lockPasscode,\r\n        tags: note.tags,\r\n        isEncrypted: note.isEncrypted,\r\n        groupId: note.groupId || null\r\n      };\r\n\r\n      if (!user?.$id) throw new Error('Not authenticated');\r\n\r\n      if (id && id !== 'new') {\r\n        await notesDb.updateNote(id, user.$id, noteData);\r\n      } else {\r\n        await notesDb.createNote(user.$id, noteData);\r\n      }\r\n      navigate('/');\r\n    } catch (error) {\r\n      console.error('Error saving note:', error);\r\n      setError(error?.message || error?.response?.data?.message || 'Error saving note');\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    if (isDirty) {\r\n      const ok = window.confirm('You have unsaved changes. Are you sure? Any unsaved work will be lost.');\r\n      if (!ok) return;\r\n    }\r\n    navigate('/');\r\n  };\r\n\r\n  if (loading) {\r\n    return <Typography>Loading...</Typography>;\r\n  }\r\n\r\n  return (\r\n    <Box component=\"form\" onSubmit={handleSubmit} sx={{ maxWidth: 800, mx: 'auto', p: 3 }}>\r\n      {/* Breadcrumbs */}\r\n      <Breadcrumbs sx={{ mb: 3 }}>\r\n        <Link\r\n          component=\"button\"\r\n          variant=\"body1\"\r\n          onClick={() => navigate('/')}\r\n          sx={{ display: 'flex', alignItems: 'center', gap: 0.5, textDecoration: 'none' }}\r\n        >\r\n          <HomeIcon fontSize=\"small\" />\r\n          Home\r\n        </Link>\r\n        <Link\r\n          component=\"button\"\r\n          variant=\"body1\"\r\n          onClick={() => navigate('/')}\r\n          sx={{ display: 'flex', alignItems: 'center', gap: 0.5, textDecoration: 'none' }}\r\n        >\r\n          <NotesIcon fontSize=\"small\" />\r\n          Notes\r\n        </Link>\r\n        <Typography color=\"text.primary\" sx={{ display: 'flex', alignItems: 'center' }}>\r\n          {id === 'new' ? 'New Note' : (note.title || 'Untitled')}\r\n        </Typography>\r\n      </Breadcrumbs>\r\n\r\n      {/* Auto-save indicator */}\r\n      {(isSaving || lastSaved) && (\r\n        <Box sx={{ mb: 2, display: 'flex', alignItems: 'center', gap: 1 }}>\r\n          {isSaving ? (\r\n            <Typography variant=\"caption\" color=\"text.secondary\">\r\n              Saving...\r\n            </Typography>\r\n          ) : (\r\n            <>\r\n              <CheckCircleIcon fontSize=\"small\" color=\"success\" />\r\n              <Typography variant=\"caption\" color=\"text.secondary\">\r\n                Saved {lastSaved ? dayjs(lastSaved).format('MMM D, YYYY [at] h:mm A') : 'just now'}\r\n              </Typography>\r\n            </>\r\n          )}\r\n        </Box>\r\n      )}\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n      \r\n      <Box sx={{ mb: 2 }}>\r\n        <TextField\r\n          fullWidth\r\n          label=\"Title\"\r\n          name=\"title\"\r\n          value={note.title}\r\n          onChange={handleChange}\r\n          required\r\n          variant=\"outlined\"\r\n          sx={{ mb: 2 }}\r\n          disabled={isNoteLocked && !note.lockPasscode}\r\n        />\r\n        \r\n        <TextField\r\n          fullWidth\r\n          label=\"Content\"\r\n          name=\"content\"\r\n          value={note.content}\r\n          onChange={handleChange}\r\n          required\r\n          multiline\r\n          rows={12}\r\n          variant=\"outlined\"\r\n          sx={{ mb: 2 }}\r\n          disabled={isNoteLocked && !note.lockPasscode}\r\n        />\r\n\r\n        <FormControl fullWidth sx={{ mb: 2 }}>\r\n          <InputLabel>Group</InputLabel>\r\n          <Select\r\n            name=\"groupId\"\r\n            value={note.groupId || ''}\r\n            onChange={handleChange}\r\n            label=\"Group\"\r\n          >\r\n            <MenuItem value=\"\">\r\n              <em>No Group</em>\r\n            </MenuItem>\r\n            {Array.isArray(groups) && groups.map((group) => (\r\n              <MenuItem key={group._id || group.$id} value={group._id || group.$id}>\r\n                {group.name}\r\n                {group.description && (\r\n                  <Typography variant=\"caption\" color=\"text.secondary\" sx={{ ml: 1 }}>\r\n                    - {group.description}\r\n                  </Typography>\r\n                )}\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </FormControl>\r\n      </Box>\r\n\r\n      <Box sx={{ mb: 2 }}>\r\n        <Typography variant=\"subtitle2\" sx={{ mb: 1, fontWeight: 'medium' }}>\r\n          Tags\r\n        </Typography>\r\n        <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mb: 1 }}>\r\n          <TextField\r\n            label=\"Add Tag\"\r\n            value={newTag}\r\n            onChange={(e) => setNewTag(e.target.value)}\r\n            onKeyPress={(e) => {\r\n              if (e.key === 'Enter') {\r\n                e.preventDefault();\r\n                handleAddTag();\r\n              }\r\n            }}\r\n            size=\"small\"\r\n            placeholder=\"Type and press Enter\"\r\n            sx={{ flexGrow: 1 }}\r\n          />\r\n          <IconButton \r\n            onClick={handleAddTag} \r\n            size=\"small\"\r\n            color=\"primary\"\r\n            disabled={!newTag.trim()}\r\n          >\r\n            <AddIcon />\r\n          </IconButton>\r\n        </Stack>\r\n        <Box sx={{ mt: 1, display: 'flex', flexWrap: 'wrap', gap: 0.5 }}>\r\n          {note.tags.length === 0 ? (\r\n            <Typography variant=\"caption\" color=\"text.secondary\">\r\n              No tags yet. Add tags to organize your notes.\r\n            </Typography>\r\n          ) : (\r\n            note.tags.map((tag) => (\r\n              <Chip\r\n                key={tag}\r\n                label={tag}\r\n                onDelete={() => handleDeleteTag(tag)}\r\n                color=\"primary\"\r\n                variant=\"outlined\"\r\n                sx={{ \r\n                  '& .MuiChip-deleteIcon': {\r\n                    color: 'primary.main',\r\n                    '&:hover': {\r\n                      color: 'primary.dark'\r\n                    }\r\n                  }\r\n                }}\r\n              />\r\n            ))\r\n          )}\r\n        </Box>\r\n      </Box>\r\n\r\n      <Box sx={{ mb: 2 }}>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={note.isEncrypted}\r\n              onChange={(e) => setNote({ ...note, isEncrypted: e.target.checked })}\r\n            />\r\n          }\r\n          label=\"Encrypt Note\"\r\n        />\r\n        <IconButton onClick={handleToggleLock} color={note.isLocked ? 'primary' : 'default'}>\r\n          {note.isLocked ? <LockIcon /> : <LockOpenIcon />}\r\n        </IconButton>\r\n      </Box>\r\n\r\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mt: 3 }}>\r\n        <Box>\r\n          {isDirty && !isSaving && (\r\n            <Typography variant=\"caption\" color=\"warning.main\">\r\n              You have unsaved changes\r\n            </Typography>\r\n          )}\r\n        </Box>\r\n        <Box>\r\n          <Button\r\n            type=\"submit\"\r\n            variant=\"contained\"\r\n            startIcon={<SaveIcon />}\r\n            sx={{ mr: 1 }}\r\n            disabled={isSaving}\r\n          >\r\n            {isSaving ? 'Saving...' : 'Save'}\r\n          </Button>\r\n          <Button variant=\"outlined\" onClick={handleCancel}> \r\n            Cancel\r\n          </Button>\r\n        </Box>\r\n      </Box>\r\n\r\n      <Dialog \r\n        open={passcodeDialogOpen} \r\n        onClose={() => {\r\n          if (id === 'new') {\r\n            setPasscodeDialogOpen(false);\r\n          } else {\r\n            navigate('/');\r\n          }\r\n        }}\r\n      >\r\n        <DialogTitle>\r\n          {id === 'new' ? 'Set Note Passcode' : 'Enter Note Passcode'}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <TextField\r\n            autoFocus\r\n            margin=\"dense\"\r\n            label=\"Passcode\"\r\n            type=\"password\"\r\n            fullWidth\r\n            value={passcode}\r\n            onChange={(e) => setPasscode(e.target.value)}\r\n            error={passcodeAttempts > 0}\r\n            helperText={passcodeAttempts > 0 ? `${3 - passcodeAttempts} attempts remaining` : ''}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => navigate('/')}>Cancel</Button>\r\n          <Button \r\n            onClick={handlePasscodeSubmit} \r\n            variant=\"contained\"\r\n            disabled={passcodeAttempts >= 3}\r\n          >\r\n            {id === 'new' ? 'Set Passcode' : 'Submit'}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default NoteEditor; "],"names":["isTwingate","window","location","hostname","includes","isLocalhost","baseURL","process","REACT_APP_TWINGATE_API_URL","console","log","api","axios","create","withCredentials","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","status","removeItem","href","useGroups","userId","useQuery","queryKey","queryFn","async","groupsService","map","g","_id","$id","name","description","members","membersWithInfo","memberNicknames","ownerId","enabled","staleTime","useCreateGroup","queryClient","useQueryClient","useMutation","mutationFn","groupData","_ref","onSuccess","data","variables","invalidateQueries","useDeleteGroup","groupId","_ref2","DATABASE_ID","NOTES_COLLECTION_ID","createNote","note","permissions","Permission","read","Role","user","update","delete","write","databases","createDocument","err","_err$response","_err$response2","msg","message","code","String","toLowerCase","listNotes","notes","listDocuments","Query","equal","documents","PROFILES_COLLECTION_ID","all","profiles","length","profile","owner","email","warn","res","filter","d","e","updateNote","documentId","updateDocument","deleteNote","deleteDocument","GROUPS_COLLECTION_ID","listGroups","arguments","undefined","queries","push","or","isNull","groups","group","Array","isArray","JSON","parse","memberProfiles","memberId","nickname","createGroup","Error","users","ID","unique","trim","type","addMemberToGroup","userEmail","getDocument","currentMembers","updatedMembers","stringify","removeMemberFromGroup","m","deleteGroup","NoteEditor","id","useParams","navigate","useNavigate","useLocation","useAuth","groupIdFromUrl","URLSearchParams","search","get","setNote","useState","title","content","isLocked","lockPasscode","isEncrypted","tags","originalContent","setOriginalContent","loading","setLoading","setError","passcodeDialogOpen","setPasscodeDialogOpen","newTag","setNewTag","passcode","setPasscode","isNoteLocked","setIsNoteLocked","passcodeAttempts","setPasscodeAttempts","isSettingLockPasscode","setIsSettingLockPasscode","initialSnapshotRef","useRef","isDirty","setIsDirty","lastSaved","setLastSaved","isSaving","setIsSaving","autoSaveTimerRef","useEffect","fetchNote","current","providedPasscode","metadata","url","encodeURIComponent","noteData","_error$response2","_error$response3","_error$response4","_error$response4$data","prev","newAttempts","setTimeout","handleChange","value","target","base","dirty","__unsavedChanges","clearTimeout","notesDb","Date","beforeUnload","preventDefault","returnValue","addEventListener","removeEventListener","handleAddTag","_jsx","Typography","children","_jsxs","Box","component","onSubmit","_error$response6","_error$response6$data","sx","maxWidth","mx","p","Breadcrumbs","mb","Link","variant","onClick","display","alignItems","gap","textDecoration","HomeIcon","fontSize","NotesIcon","color","_Fragment","CheckCircleIcon","dayjs","format","Alert","severity","TextField","fullWidth","label","onChange","required","disabled","multiline","rows","FormControl","InputLabel","Select","MenuItem","ml","fontWeight","Stack","direction","spacing","onKeyPress","key","size","placeholder","flexGrow","IconButton","AddIcon","mt","flexWrap","tag","Chip","onDelete","handleDeleteTag","tagToDelete","FormControlLabel","control","Switch","checked","handleToggleLock","LockIcon","LockOpenIcon","justifyContent","Button","startIcon","SaveIcon","mr","handleCancel","confirm","Dialog","open","onClose","DialogTitle","DialogContent","autoFocus","margin","helperText","DialogActions","_error$response5","_error$response5$data"],"sourceRoot":""}